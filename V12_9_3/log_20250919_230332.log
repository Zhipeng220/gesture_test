2025-09-19 23:03:32,092 - INFO - Logging to: logs_v2/log_20250919_230332.log
2025-09-19 23:03:32,108 - INFO - CUDA backend detected. Using NVIDIA GPU for acceleration.
2025-09-19 23:03:32,108 - INFO - Successfully loaded all experiment configurations and file paths.
2025-09-19 23:03:32,108 - INFO - --- Loading and Combining Data from All Sources ---
2025-09-19 23:03:32,488 - INFO - Combined data shape: (164969, 49)
2025-09-19 23:03:32,490 - INFO - Found 14 unique classes.
2025-09-19 23:03:35,062 - INFO - Processed 1580 valid sequences.
2025-09-19 23:03:35,064 - INFO - Calculated class weights for Focal Loss.
2025-09-19 23:03:35,064 - INFO - Creating a hold-out test set based on subject IDs...
2025-09-19 23:03:35,064 - INFO - Data split: 1310 for Train/Val (CV), 270 for Final Test.
2025-09-19 23:03:35,066 - INFO - Creating a single train/validation split based on subject IDs...
2025-09-19 23:03:35,067 - INFO - 
========================= Running Experiment: 27_Exp_V18_Hybrid_Sparsity02 =========================
2025-09-19 23:03:35,364 - INFO - Model initialization check passed. All parameters are finite.
2025-09-19 23:04:25,675 - INFO - Epoch 1/200 | LR: 1.00e-05 | Train Loss: 2.5785 | Val Loss: 2.0947 | Val Acc: 0.1486 | Val F1: 0.0679
2025-09-19 23:04:25,676 - INFO - Validation metric improved (-inf --> 0.067924). Saving model...
2025-09-19 23:05:15,300 - INFO - Epoch 2/200 | LR: 1.50e-05 | Train Loss: 2.1690 | Val Loss: 1.6891 | Val Acc: 0.2384 | Val F1: 0.1786
2025-09-19 23:05:15,301 - INFO - Validation metric improved (0.067924 --> 0.178568). Saving model...
2025-09-19 23:06:06,299 - INFO - Epoch 3/200 | LR: 2.00e-05 | Train Loss: 1.9821 | Val Loss: 1.4785 | Val Acc: 0.3220 | Val F1: 0.2347
2025-09-19 23:06:06,300 - INFO - Validation metric improved (0.178568 --> 0.234692). Saving model...
2025-09-19 23:06:56,592 - INFO - Epoch 4/200 | LR: 2.50e-05 | Train Loss: 1.8574 | Val Loss: 1.2728 | Val Acc: 0.3746 | Val F1: 0.2918
2025-09-19 23:06:56,594 - INFO - Validation metric improved (0.234692 --> 0.291785). Saving model...
2025-09-19 23:07:46,202 - INFO - Epoch 5/200 | LR: 3.00e-05 | Train Loss: 1.7636 | Val Loss: 1.3055 | Val Acc: 0.4458 | Val F1: 0.4127
2025-09-19 23:07:46,203 - INFO - Validation metric improved (0.291785 --> 0.412674). Saving model...
2025-09-19 23:08:35,767 - INFO - Epoch 6/200 | LR: 3.50e-05 | Train Loss: 1.5958 | Val Loss: 0.9022 | Val Acc: 0.5046 | Val F1: 0.4615
2025-09-19 23:08:35,768 - INFO - Validation metric improved (0.412674 --> 0.461455). Saving model...
2025-09-19 23:09:25,755 - INFO - Epoch 7/200 | LR: 4.00e-05 | Train Loss: 1.4077 | Val Loss: 0.9487 | Val Acc: 0.4737 | Val F1: 0.4342
2025-09-19 23:09:25,756 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:10:15,334 - INFO - Epoch 8/200 | LR: 4.50e-05 | Train Loss: 1.4398 | Val Loss: 0.9206 | Val Acc: 0.4799 | Val F1: 0.4353
2025-09-19 23:10:15,335 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:11:05,041 - INFO - Epoch 9/200 | LR: 5.00e-05 | Train Loss: 1.3889 | Val Loss: 0.9941 | Val Acc: 0.5263 | Val F1: 0.4763
2025-09-19 23:11:05,042 - INFO - Validation metric improved (0.461455 --> 0.476272). Saving model...
2025-09-19 23:11:54,914 - INFO - Epoch 10/200 | LR: 5.00e-05 | Train Loss: 1.3443 | Val Loss: 0.7926 | Val Acc: 0.5882 | Val F1: 0.5354
2025-09-19 23:11:54,916 - INFO - Validation metric improved (0.476272 --> 0.535445). Saving model...
2025-09-19 23:12:44,628 - INFO - Epoch 11/200 | LR: 5.00e-05 | Train Loss: 1.2172 | Val Loss: 0.7598 | Val Acc: 0.5944 | Val F1: 0.5663
2025-09-19 23:12:44,628 - INFO - Validation metric improved (0.535445 --> 0.566343). Saving model...
2025-09-19 23:13:34,352 - INFO - Epoch 12/200 | LR: 5.00e-05 | Train Loss: 1.2749 | Val Loss: 0.6763 | Val Acc: 0.6316 | Val F1: 0.6147
2025-09-19 23:13:34,353 - INFO - Validation metric improved (0.566343 --> 0.614684). Saving model...
2025-09-19 23:14:24,111 - INFO - Epoch 13/200 | LR: 5.00e-05 | Train Loss: 1.2481 | Val Loss: 0.6594 | Val Acc: 0.6254 | Val F1: 0.6290
2025-09-19 23:14:24,112 - INFO - Validation metric improved (0.614684 --> 0.628955). Saving model...
2025-09-19 23:15:14,398 - INFO - Epoch 14/200 | LR: 4.99e-05 | Train Loss: 1.1754 | Val Loss: 0.6618 | Val Acc: 0.6378 | Val F1: 0.6276
2025-09-19 23:15:14,399 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:16:05,182 - INFO - Epoch 15/200 | LR: 4.99e-05 | Train Loss: 1.0682 | Val Loss: 0.5907 | Val Acc: 0.6533 | Val F1: 0.6459
2025-09-19 23:16:05,183 - INFO - Validation metric improved (0.628955 --> 0.645905). Saving model...
2025-09-19 23:16:54,982 - INFO - Epoch 16/200 | LR: 4.99e-05 | Train Loss: 1.1847 | Val Loss: 0.6595 | Val Acc: 0.6502 | Val F1: 0.6231
2025-09-19 23:16:54,983 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:17:44,643 - INFO - Epoch 17/200 | LR: 4.98e-05 | Train Loss: 1.1386 | Val Loss: 0.5655 | Val Acc: 0.6966 | Val F1: 0.6721
2025-09-19 23:17:44,644 - INFO - Validation metric improved (0.645905 --> 0.672111). Saving model...
2025-09-19 23:18:34,242 - INFO - Epoch 18/200 | LR: 4.98e-05 | Train Loss: 1.1914 | Val Loss: 0.5632 | Val Acc: 0.6749 | Val F1: 0.6528
2025-09-19 23:18:34,243 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:19:23,714 - INFO - Epoch 19/200 | LR: 4.97e-05 | Train Loss: 1.0594 | Val Loss: 0.5207 | Val Acc: 0.7152 | Val F1: 0.7071
2025-09-19 23:19:23,716 - INFO - Validation metric improved (0.672111 --> 0.707146). Saving model...
2025-09-19 23:20:13,535 - INFO - Epoch 20/200 | LR: 4.97e-05 | Train Loss: 1.0838 | Val Loss: 0.5414 | Val Acc: 0.6718 | Val F1: 0.6492
2025-09-19 23:20:13,536 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:21:03,052 - INFO - Epoch 21/200 | LR: 4.96e-05 | Train Loss: 1.0833 | Val Loss: 0.5001 | Val Acc: 0.7152 | Val F1: 0.7160
2025-09-19 23:21:03,053 - INFO - Validation metric improved (0.707146 --> 0.715978). Saving model...
2025-09-19 23:21:52,640 - INFO - Epoch 22/200 | LR: 4.95e-05 | Train Loss: 1.0925 | Val Loss: 0.4665 | Val Acc: 0.7307 | Val F1: 0.7310
2025-09-19 23:21:52,641 - INFO - Validation metric improved (0.715978 --> 0.730958). Saving model...
2025-09-19 23:22:42,283 - INFO - Epoch 23/200 | LR: 4.94e-05 | Train Loss: 1.0451 | Val Loss: 0.5052 | Val Acc: 0.7059 | Val F1: 0.6926
2025-09-19 23:22:42,284 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:23:32,064 - INFO - Epoch 24/200 | LR: 4.93e-05 | Train Loss: 1.0136 | Val Loss: 0.4391 | Val Acc: 0.7461 | Val F1: 0.7473
2025-09-19 23:23:32,065 - INFO - Validation metric improved (0.730958 --> 0.747307). Saving model...
2025-09-19 23:24:21,755 - INFO - Epoch 25/200 | LR: 4.92e-05 | Train Loss: 1.0135 | Val Loss: 0.5056 | Val Acc: 0.7152 | Val F1: 0.7144
2025-09-19 23:24:21,756 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:25:11,334 - INFO - Epoch 26/200 | LR: 4.91e-05 | Train Loss: 1.0089 | Val Loss: 0.4433 | Val Acc: 0.7059 | Val F1: 0.6979
2025-09-19 23:25:11,335 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:26:01,001 - INFO - Epoch 27/200 | LR: 4.90e-05 | Train Loss: 1.0032 | Val Loss: 0.4984 | Val Acc: 0.6842 | Val F1: 0.6811
2025-09-19 23:26:01,002 - INFO - EarlyStopping counter: 3 / 40
2025-09-19 23:26:50,520 - INFO - Epoch 28/200 | LR: 4.89e-05 | Train Loss: 0.9708 | Val Loss: 0.4021 | Val Acc: 0.7337 | Val F1: 0.7406
2025-09-19 23:26:50,521 - INFO - EarlyStopping counter: 4 / 40
2025-09-19 23:27:40,114 - INFO - Epoch 29/200 | LR: 4.88e-05 | Train Loss: 1.0377 | Val Loss: 0.3668 | Val Acc: 0.8019 | Val F1: 0.8029
2025-09-19 23:27:40,115 - INFO - Validation metric improved (0.747307 --> 0.802898). Saving model...
2025-09-19 23:28:29,855 - INFO - Epoch 30/200 | LR: 4.86e-05 | Train Loss: 0.9010 | Val Loss: 0.4077 | Val Acc: 0.7523 | Val F1: 0.7404
2025-09-19 23:28:29,855 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:29:19,323 - INFO - Epoch 31/200 | LR: 4.85e-05 | Train Loss: 0.9766 | Val Loss: 0.4100 | Val Acc: 0.7678 | Val F1: 0.7704
2025-09-19 23:29:19,324 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:30:08,722 - INFO - Epoch 32/200 | LR: 4.84e-05 | Train Loss: 0.9584 | Val Loss: 0.4021 | Val Acc: 0.7585 | Val F1: 0.7581
2025-09-19 23:30:08,723 - INFO - EarlyStopping counter: 3 / 40
2025-09-19 23:30:58,157 - INFO - Epoch 33/200 | LR: 4.82e-05 | Train Loss: 0.9726 | Val Loss: 0.3361 | Val Acc: 0.7802 | Val F1: 0.7779
2025-09-19 23:30:58,158 - INFO - EarlyStopping counter: 4 / 40
2025-09-19 23:31:47,549 - INFO - Epoch 34/200 | LR: 4.81e-05 | Train Loss: 0.9231 | Val Loss: 0.3905 | Val Acc: 0.7926 | Val F1: 0.7914
2025-09-19 23:31:47,550 - INFO - EarlyStopping counter: 5 / 40
2025-09-19 23:32:37,032 - INFO - Epoch 35/200 | LR: 4.79e-05 | Train Loss: 0.9617 | Val Loss: 0.3952 | Val Acc: 0.7121 | Val F1: 0.6972
2025-09-19 23:32:37,033 - INFO - EarlyStopping counter: 6 / 40
2025-09-19 23:33:26,687 - INFO - Epoch 36/200 | LR: 4.77e-05 | Train Loss: 0.9139 | Val Loss: 0.3421 | Val Acc: 0.7895 | Val F1: 0.7919
2025-09-19 23:33:26,688 - INFO - EarlyStopping counter: 7 / 40
2025-09-19 23:34:16,219 - INFO - Epoch 37/200 | LR: 4.76e-05 | Train Loss: 0.8781 | Val Loss: 0.4966 | Val Acc: 0.7183 | Val F1: 0.6976
2025-09-19 23:34:16,220 - INFO - EarlyStopping counter: 8 / 40
2025-09-19 23:35:05,939 - INFO - Epoch 38/200 | LR: 4.74e-05 | Train Loss: 0.9088 | Val Loss: 0.3363 | Val Acc: 0.7895 | Val F1: 0.7883
2025-09-19 23:35:05,939 - INFO - EarlyStopping counter: 9 / 40
2025-09-19 23:35:55,491 - INFO - Epoch 39/200 | LR: 4.72e-05 | Train Loss: 0.9546 | Val Loss: 0.3582 | Val Acc: 0.7833 | Val F1: 0.7773
2025-09-19 23:35:55,492 - INFO - EarlyStopping counter: 10 / 40
2025-09-19 23:36:44,942 - INFO - Epoch 40/200 | LR: 4.70e-05 | Train Loss: 0.8841 | Val Loss: 0.3473 | Val Acc: 0.7926 | Val F1: 0.7907
2025-09-19 23:36:44,942 - INFO - EarlyStopping counter: 11 / 40
2025-09-19 23:37:34,594 - INFO - Epoch 41/200 | LR: 4.68e-05 | Train Loss: 0.8962 | Val Loss: 0.3009 | Val Acc: 0.7833 | Val F1: 0.7768
2025-09-19 23:37:34,595 - INFO - EarlyStopping counter: 12 / 40
2025-09-19 23:38:24,092 - INFO - Epoch 42/200 | LR: 4.66e-05 | Train Loss: 0.8944 | Val Loss: 0.3461 | Val Acc: 0.7833 | Val F1: 0.7770
2025-09-19 23:38:24,093 - INFO - EarlyStopping counter: 13 / 40
2025-09-19 23:39:13,871 - INFO - Epoch 43/200 | LR: 4.64e-05 | Train Loss: 0.8546 | Val Loss: 0.3456 | Val Acc: 0.7740 | Val F1: 0.7653
2025-09-19 23:39:13,872 - INFO - EarlyStopping counter: 14 / 40
2025-09-19 23:40:03,346 - INFO - Epoch 44/200 | LR: 4.62e-05 | Train Loss: 0.8149 | Val Loss: 0.3599 | Val Acc: 0.7833 | Val F1: 0.7873
2025-09-19 23:40:03,347 - INFO - EarlyStopping counter: 15 / 40
2025-09-19 23:40:52,906 - INFO - Epoch 45/200 | LR: 4.59e-05 | Train Loss: 0.9293 | Val Loss: 0.3523 | Val Acc: 0.7616 | Val F1: 0.7709
2025-09-19 23:40:52,907 - INFO - EarlyStopping counter: 16 / 40
2025-09-19 23:41:42,220 - INFO - Epoch 46/200 | LR: 4.57e-05 | Train Loss: 0.9066 | Val Loss: 0.3290 | Val Acc: 0.8111 | Val F1: 0.8067
2025-09-19 23:41:42,221 - INFO - Validation metric improved (0.802898 --> 0.806728). Saving model...
2025-09-19 23:42:31,441 - INFO - Epoch 47/200 | LR: 4.55e-05 | Train Loss: 0.8895 | Val Loss: 0.3659 | Val Acc: 0.7678 | Val F1: 0.7623
2025-09-19 23:42:31,442 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:43:20,496 - INFO - Epoch 48/200 | LR: 4.52e-05 | Train Loss: 0.8529 | Val Loss: 0.3464 | Val Acc: 0.7988 | Val F1: 0.7976
2025-09-19 23:43:20,497 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:44:09,792 - INFO - Epoch 49/200 | LR: 4.50e-05 | Train Loss: 0.8457 | Val Loss: 0.3168 | Val Acc: 0.8111 | Val F1: 0.8031
2025-09-19 23:44:09,793 - INFO - EarlyStopping counter: 3 / 40
2025-09-19 23:44:58,801 - INFO - Epoch 50/200 | LR: 4.47e-05 | Train Loss: 0.8543 | Val Loss: 0.2983 | Val Acc: 0.8019 | Val F1: 0.8060
2025-09-19 23:44:58,802 - INFO - EarlyStopping counter: 4 / 40
2025-09-19 23:45:48,124 - INFO - Epoch 51/200 | LR: 4.45e-05 | Train Loss: 0.8254 | Val Loss: 0.2609 | Val Acc: 0.8421 | Val F1: 0.8442
2025-09-19 23:45:48,125 - INFO - Validation metric improved (0.806728 --> 0.844175). Saving model...
2025-09-19 23:46:37,248 - INFO - Epoch 52/200 | LR: 4.42e-05 | Train Loss: 0.8186 | Val Loss: 0.2328 | Val Acc: 0.8359 | Val F1: 0.8365
2025-09-19 23:46:37,249 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:47:26,162 - INFO - Epoch 53/200 | LR: 4.40e-05 | Train Loss: 0.8447 | Val Loss: 0.2944 | Val Acc: 0.7957 | Val F1: 0.7963
2025-09-19 23:47:26,163 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:48:15,044 - INFO - Epoch 54/200 | LR: 4.37e-05 | Train Loss: 0.9105 | Val Loss: 0.2949 | Val Acc: 0.8142 | Val F1: 0.8214
2025-09-19 23:48:15,045 - INFO - EarlyStopping counter: 3 / 40
2025-09-19 23:49:04,248 - INFO - Epoch 55/200 | LR: 4.34e-05 | Train Loss: 0.7270 | Val Loss: 0.2944 | Val Acc: 0.7802 | Val F1: 0.7744
2025-09-19 23:49:04,249 - INFO - EarlyStopping counter: 4 / 40
2025-09-19 23:49:53,471 - INFO - Epoch 56/200 | LR: 4.31e-05 | Train Loss: 0.8314 | Val Loss: 0.2707 | Val Acc: 0.8390 | Val F1: 0.8387
2025-09-19 23:49:53,472 - INFO - EarlyStopping counter: 5 / 40
2025-09-19 23:50:42,534 - INFO - Epoch 57/200 | LR: 4.28e-05 | Train Loss: 0.7707 | Val Loss: 0.2753 | Val Acc: 0.8452 | Val F1: 0.8438
2025-09-19 23:50:42,535 - INFO - EarlyStopping counter: 6 / 40
2025-09-19 23:51:31,649 - INFO - Epoch 58/200 | LR: 4.25e-05 | Train Loss: 0.8285 | Val Loss: 0.2677 | Val Acc: 0.8266 | Val F1: 0.8337
2025-09-19 23:51:31,650 - INFO - EarlyStopping counter: 7 / 40
2025-09-19 23:52:20,977 - INFO - Epoch 59/200 | LR: 4.22e-05 | Train Loss: 0.6718 | Val Loss: 0.2735 | Val Acc: 0.8390 | Val F1: 0.8338
2025-09-19 23:52:20,978 - INFO - EarlyStopping counter: 8 / 40
2025-09-19 23:53:10,182 - INFO - Epoch 60/200 | LR: 4.19e-05 | Train Loss: 0.7456 | Val Loss: 0.3122 | Val Acc: 0.7988 | Val F1: 0.7938
2025-09-19 23:53:10,184 - INFO - EarlyStopping counter: 9 / 40
2025-09-19 23:53:59,069 - INFO - Epoch 61/200 | LR: 4.16e-05 | Train Loss: 0.7237 | Val Loss: 0.2599 | Val Acc: 0.8235 | Val F1: 0.8294
2025-09-19 23:53:59,070 - INFO - EarlyStopping counter: 10 / 40
2025-09-19 23:54:48,227 - INFO - Epoch 62/200 | LR: 4.13e-05 | Train Loss: 0.7633 | Val Loss: 0.2737 | Val Acc: 0.8111 | Val F1: 0.8054
2025-09-19 23:54:48,229 - INFO - EarlyStopping counter: 11 / 40
2025-09-19 23:55:37,341 - INFO - Epoch 63/200 | LR: 4.10e-05 | Train Loss: 0.6272 | Val Loss: 0.2530 | Val Acc: 0.8452 | Val F1: 0.8439
2025-09-19 23:55:37,342 - INFO - EarlyStopping counter: 12 / 40
2025-09-19 23:55:47,392 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-19 23:55:47,393 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-19 23:56:26,202 - INFO - Epoch 64/200 | LR: 4.07e-05 | Train Loss: 0.7187 | Val Loss: 0.2092 | Val Acc: 0.8452 | Val F1: 0.8499
2025-09-19 23:56:26,203 - INFO - Validation metric improved (0.844175 --> 0.849860). Saving model...
2025-09-19 23:57:15,431 - INFO - Epoch 65/200 | LR: 4.04e-05 | Train Loss: 0.7883 | Val Loss: 0.2235 | Val Acc: 0.8576 | Val F1: 0.8553
2025-09-19 23:57:15,432 - INFO - Validation metric improved (0.849860 --> 0.855334). Saving model...
2025-09-19 23:58:04,691 - INFO - Epoch 66/200 | LR: 4.00e-05 | Train Loss: 0.6637 | Val Loss: 0.2655 | Val Acc: 0.8204 | Val F1: 0.8130
2025-09-19 23:58:04,692 - INFO - EarlyStopping counter: 1 / 40
2025-09-19 23:58:53,678 - INFO - Epoch 67/200 | LR: 3.97e-05 | Train Loss: 0.7121 | Val Loss: 0.3286 | Val Acc: 0.7988 | Val F1: 0.8028
2025-09-19 23:58:53,679 - INFO - EarlyStopping counter: 2 / 40
2025-09-19 23:59:42,844 - INFO - Epoch 68/200 | LR: 3.94e-05 | Train Loss: 0.6837 | Val Loss: 0.2793 | Val Acc: 0.8452 | Val F1: 0.8453
2025-09-19 23:59:42,845 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:00:32,011 - INFO - Epoch 69/200 | LR: 3.90e-05 | Train Loss: 0.7378 | Val Loss: 0.2104 | Val Acc: 0.8638 | Val F1: 0.8643
2025-09-20 00:00:32,012 - INFO - Validation metric improved (0.855334 --> 0.864315). Saving model...
2025-09-20 00:01:21,481 - INFO - Epoch 70/200 | LR: 3.87e-05 | Train Loss: 0.6076 | Val Loss: 0.2256 | Val Acc: 0.8235 | Val F1: 0.8243
2025-09-20 00:01:21,482 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:02:10,755 - INFO - Epoch 71/200 | LR: 3.83e-05 | Train Loss: 0.7414 | Val Loss: 0.3219 | Val Acc: 0.8173 | Val F1: 0.8184
2025-09-20 00:02:10,756 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:03:00,047 - INFO - Epoch 72/200 | LR: 3.80e-05 | Train Loss: 0.6840 | Val Loss: 0.2194 | Val Acc: 0.8638 | Val F1: 0.8646
2025-09-20 00:03:00,048 - INFO - Validation metric improved (0.864315 --> 0.864562). Saving model...
2025-09-20 00:03:49,338 - INFO - Epoch 73/200 | LR: 3.76e-05 | Train Loss: 0.7390 | Val Loss: 0.2414 | Val Acc: 0.8421 | Val F1: 0.8427
2025-09-20 00:03:49,339 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:04:38,551 - INFO - Epoch 74/200 | LR: 3.73e-05 | Train Loss: 0.7777 | Val Loss: 0.2441 | Val Acc: 0.8483 | Val F1: 0.8478
2025-09-20 00:04:38,553 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:05:27,448 - INFO - Epoch 75/200 | LR: 3.69e-05 | Train Loss: 0.7908 | Val Loss: 0.1917 | Val Acc: 0.8669 | Val F1: 0.8667
2025-09-20 00:05:27,449 - INFO - Validation metric improved (0.864562 --> 0.866689). Saving model...
2025-09-20 00:06:16,712 - INFO - Epoch 76/200 | LR: 3.66e-05 | Train Loss: 0.7208 | Val Loss: 0.2016 | Val Acc: 0.8731 | Val F1: 0.8723
2025-09-20 00:06:16,713 - INFO - Validation metric improved (0.866689 --> 0.872305). Saving model...
2025-09-20 00:07:06,133 - INFO - Epoch 77/200 | LR: 3.62e-05 | Train Loss: 0.6320 | Val Loss: 0.2331 | Val Acc: 0.8514 | Val F1: 0.8544
2025-09-20 00:07:06,134 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:07:55,184 - INFO - Epoch 78/200 | LR: 3.58e-05 | Train Loss: 0.6449 | Val Loss: 0.2260 | Val Acc: 0.8483 | Val F1: 0.8460
2025-09-20 00:07:55,185 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:08:44,354 - INFO - Epoch 79/200 | LR: 3.54e-05 | Train Loss: 0.6713 | Val Loss: 0.2213 | Val Acc: 0.8669 | Val F1: 0.8670
2025-09-20 00:08:44,356 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:09:33,705 - INFO - Epoch 80/200 | LR: 3.51e-05 | Train Loss: 0.6626 | Val Loss: 0.2643 | Val Acc: 0.8545 | Val F1: 0.8584
2025-09-20 00:09:33,705 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 00:10:22,657 - INFO - Epoch 81/200 | LR: 3.47e-05 | Train Loss: 0.7194 | Val Loss: 0.2209 | Val Acc: 0.8669 | Val F1: 0.8678
2025-09-20 00:10:22,658 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 00:11:11,653 - INFO - Epoch 82/200 | LR: 3.43e-05 | Train Loss: 0.7356 | Val Loss: 0.1940 | Val Acc: 0.8793 | Val F1: 0.8829
2025-09-20 00:11:11,654 - INFO - Validation metric improved (0.872305 --> 0.882870). Saving model...
2025-09-20 00:12:00,779 - INFO - Epoch 83/200 | LR: 3.39e-05 | Train Loss: 0.7035 | Val Loss: 0.1948 | Val Acc: 0.8731 | Val F1: 0.8726
2025-09-20 00:12:00,780 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:12:49,952 - INFO - Epoch 84/200 | LR: 3.35e-05 | Train Loss: 0.6750 | Val Loss: 0.1839 | Val Acc: 0.8854 | Val F1: 0.8876
2025-09-20 00:12:49,953 - INFO - Validation metric improved (0.882870 --> 0.887639). Saving model...
2025-09-20 00:13:39,026 - INFO - Epoch 85/200 | LR: 3.32e-05 | Train Loss: 0.6311 | Val Loss: 0.2121 | Val Acc: 0.8669 | Val F1: 0.8674
2025-09-20 00:13:39,027 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:14:28,254 - INFO - Epoch 86/200 | LR: 3.28e-05 | Train Loss: 0.6396 | Val Loss: 0.1850 | Val Acc: 0.8638 | Val F1: 0.8685
2025-09-20 00:14:28,255 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:15:17,379 - INFO - Epoch 87/200 | LR: 3.24e-05 | Train Loss: 0.6679 | Val Loss: 0.1877 | Val Acc: 0.8514 | Val F1: 0.8557
2025-09-20 00:15:17,380 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:16:06,415 - INFO - Epoch 88/200 | LR: 3.20e-05 | Train Loss: 0.5971 | Val Loss: 0.2087 | Val Acc: 0.8638 | Val F1: 0.8660
2025-09-20 00:16:06,417 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 00:16:55,347 - INFO - Epoch 89/200 | LR: 3.16e-05 | Train Loss: 0.6476 | Val Loss: 0.1838 | Val Acc: 0.8669 | Val F1: 0.8668
2025-09-20 00:16:55,349 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 00:17:44,513 - INFO - Epoch 90/200 | LR: 3.12e-05 | Train Loss: 0.6250 | Val Loss: 0.2277 | Val Acc: 0.8576 | Val F1: 0.8588
2025-09-20 00:17:44,514 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 00:18:33,594 - INFO - Epoch 91/200 | LR: 3.08e-05 | Train Loss: 0.6828 | Val Loss: 0.1729 | Val Acc: 0.8885 | Val F1: 0.8900
2025-09-20 00:18:33,595 - INFO - Validation metric improved (0.887639 --> 0.889996). Saving model...
2025-09-20 00:19:22,785 - INFO - Epoch 92/200 | LR: 3.04e-05 | Train Loss: 0.6344 | Val Loss: 0.1744 | Val Acc: 0.8885 | Val F1: 0.8901
2025-09-20 00:19:22,787 - INFO - Validation metric improved (0.889996 --> 0.890147). Saving model...
2025-09-20 00:20:11,838 - INFO - Epoch 93/200 | LR: 3.00e-05 | Train Loss: 0.6431 | Val Loss: 0.2080 | Val Acc: 0.8452 | Val F1: 0.8467
2025-09-20 00:20:11,840 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:21:00,940 - INFO - Epoch 94/200 | LR: 2.96e-05 | Train Loss: 0.6868 | Val Loss: 0.2057 | Val Acc: 0.8576 | Val F1: 0.8591
2025-09-20 00:21:00,941 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:21:50,025 - INFO - Epoch 95/200 | LR: 2.92e-05 | Train Loss: 0.6887 | Val Loss: 0.1875 | Val Acc: 0.8607 | Val F1: 0.8630
2025-09-20 00:21:50,026 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:22:38,931 - INFO - Epoch 96/200 | LR: 2.87e-05 | Train Loss: 0.5932 | Val Loss: 0.2117 | Val Acc: 0.8700 | Val F1: 0.8712
2025-09-20 00:22:38,932 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 00:23:28,244 - INFO - Epoch 97/200 | LR: 2.83e-05 | Train Loss: 0.6132 | Val Loss: 0.2080 | Val Acc: 0.8700 | Val F1: 0.8700
2025-09-20 00:23:28,246 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 00:24:17,209 - INFO - Epoch 98/200 | LR: 2.79e-05 | Train Loss: 0.6460 | Val Loss: 0.2053 | Val Acc: 0.8545 | Val F1: 0.8528
2025-09-20 00:24:17,211 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 00:25:06,515 - INFO - Epoch 99/200 | LR: 2.75e-05 | Train Loss: 0.6013 | Val Loss: 0.1896 | Val Acc: 0.8824 | Val F1: 0.8826
2025-09-20 00:25:06,516 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 00:25:55,864 - INFO - Epoch 100/200 | LR: 2.71e-05 | Train Loss: 0.5884 | Val Loss: 0.2159 | Val Acc: 0.8731 | Val F1: 0.8721
2025-09-20 00:25:55,865 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 00:26:45,060 - INFO - Epoch 101/200 | LR: 2.67e-05 | Train Loss: 0.5583 | Val Loss: 0.2233 | Val Acc: 0.8545 | Val F1: 0.8546
2025-09-20 00:26:45,061 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 00:27:34,507 - INFO - Epoch 102/200 | LR: 2.63e-05 | Train Loss: 0.6409 | Val Loss: 0.2283 | Val Acc: 0.8638 | Val F1: 0.8623
2025-09-20 00:27:34,508 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 00:28:23,797 - INFO - Epoch 103/200 | LR: 2.59e-05 | Train Loss: 0.5974 | Val Loss: 0.1957 | Val Acc: 0.8700 | Val F1: 0.8703
2025-09-20 00:28:23,798 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 00:29:13,161 - INFO - Epoch 104/200 | LR: 2.55e-05 | Train Loss: 0.6171 | Val Loss: 0.1805 | Val Acc: 0.8824 | Val F1: 0.8830
2025-09-20 00:29:13,162 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 00:30:02,749 - INFO - Epoch 105/200 | LR: 2.51e-05 | Train Loss: 0.5983 | Val Loss: 0.2329 | Val Acc: 0.8483 | Val F1: 0.8488
2025-09-20 00:30:02,750 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 00:30:51,818 - INFO - Epoch 106/200 | LR: 2.46e-05 | Train Loss: 0.5715 | Val Loss: 0.2145 | Val Acc: 0.8700 | Val F1: 0.8675
2025-09-20 00:30:51,818 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 00:31:40,968 - INFO - Epoch 107/200 | LR: 2.42e-05 | Train Loss: 0.5718 | Val Loss: 0.1823 | Val Acc: 0.8700 | Val F1: 0.8694
2025-09-20 00:31:40,969 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 00:32:30,411 - INFO - Epoch 108/200 | LR: 2.38e-05 | Train Loss: 0.5630 | Val Loss: 0.2060 | Val Acc: 0.8762 | Val F1: 0.8750
2025-09-20 00:32:30,413 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 00:33:19,708 - INFO - Epoch 109/200 | LR: 2.34e-05 | Train Loss: 0.6617 | Val Loss: 0.1686 | Val Acc: 0.8824 | Val F1: 0.8839
2025-09-20 00:33:19,709 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 00:34:08,942 - INFO - Epoch 110/200 | LR: 2.30e-05 | Train Loss: 0.6158 | Val Loss: 0.1644 | Val Acc: 0.8978 | Val F1: 0.8980
2025-09-20 00:34:08,943 - INFO - Validation metric improved (0.890147 --> 0.898045). Saving model...
2025-09-20 00:34:57,940 - INFO - Epoch 111/200 | LR: 2.26e-05 | Train Loss: 0.6679 | Val Loss: 0.1902 | Val Acc: 0.8669 | Val F1: 0.8650
2025-09-20 00:34:57,940 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:35:46,864 - INFO - Epoch 112/200 | LR: 2.22e-05 | Train Loss: 0.5464 | Val Loss: 0.1531 | Val Acc: 0.8916 | Val F1: 0.8931
2025-09-20 00:35:46,865 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:36:36,099 - INFO - Epoch 113/200 | LR: 2.18e-05 | Train Loss: 0.5756 | Val Loss: 0.1839 | Val Acc: 0.8793 | Val F1: 0.8781
2025-09-20 00:36:36,100 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:37:17,949 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 00:37:17,950 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 00:37:24,741 - INFO - Epoch 114/200 | LR: 2.14e-05 | Train Loss: 0.6228 | Val Loss: 0.2669 | Val Acc: 0.8607 | Val F1: 0.8578
2025-09-20 00:37:24,742 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 00:38:14,160 - INFO - Epoch 115/200 | LR: 2.09e-05 | Train Loss: 0.6138 | Val Loss: 0.1843 | Val Acc: 0.8669 | Val F1: 0.8677
2025-09-20 00:38:14,161 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 00:39:03,341 - INFO - Epoch 116/200 | LR: 2.05e-05 | Train Loss: 0.5113 | Val Loss: 0.1528 | Val Acc: 0.8916 | Val F1: 0.8943
2025-09-20 00:39:03,342 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 00:39:52,657 - INFO - Epoch 117/200 | LR: 2.01e-05 | Train Loss: 0.6214 | Val Loss: 0.1752 | Val Acc: 0.8700 | Val F1: 0.8691
2025-09-20 00:39:52,658 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 00:40:41,988 - INFO - Epoch 118/200 | LR: 1.97e-05 | Train Loss: 0.5884 | Val Loss: 0.1760 | Val Acc: 0.8824 | Val F1: 0.8844
2025-09-20 00:40:41,989 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 00:41:31,488 - INFO - Epoch 119/200 | LR: 1.93e-05 | Train Loss: 0.5256 | Val Loss: 0.1814 | Val Acc: 0.8576 | Val F1: 0.8592
2025-09-20 00:41:31,489 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 00:42:20,350 - INFO - Epoch 120/200 | LR: 1.89e-05 | Train Loss: 0.5228 | Val Loss: 0.2022 | Val Acc: 0.8638 | Val F1: 0.8648
2025-09-20 00:42:20,350 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 00:43:09,858 - INFO - Epoch 121/200 | LR: 1.85e-05 | Train Loss: 0.5655 | Val Loss: 0.1805 | Val Acc: 0.8854 | Val F1: 0.8863
2025-09-20 00:43:09,859 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 00:43:59,310 - INFO - Epoch 122/200 | LR: 1.81e-05 | Train Loss: 0.5651 | Val Loss: 0.1506 | Val Acc: 0.8885 | Val F1: 0.8904
2025-09-20 00:43:59,311 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 00:44:48,192 - INFO - Epoch 123/200 | LR: 1.77e-05 | Train Loss: 0.5582 | Val Loss: 0.1474 | Val Acc: 0.8731 | Val F1: 0.8761
2025-09-20 00:44:48,193 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 00:45:37,490 - INFO - Epoch 124/200 | LR: 1.73e-05 | Train Loss: 0.5445 | Val Loss: 0.1572 | Val Acc: 0.8947 | Val F1: 0.8970
2025-09-20 00:45:37,491 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 00:46:26,816 - INFO - Epoch 125/200 | LR: 1.69e-05 | Train Loss: 0.5101 | Val Loss: 0.1630 | Val Acc: 0.8731 | Val F1: 0.8743
2025-09-20 00:46:26,817 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 00:47:16,088 - INFO - Epoch 126/200 | LR: 1.66e-05 | Train Loss: 0.5075 | Val Loss: 0.1738 | Val Acc: 0.8854 | Val F1: 0.8870
2025-09-20 00:47:16,089 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 00:48:05,235 - INFO - Epoch 127/200 | LR: 1.62e-05 | Train Loss: 0.4665 | Val Loss: 0.1643 | Val Acc: 0.8885 | Val F1: 0.8907
2025-09-20 00:48:05,236 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 00:48:54,577 - INFO - Epoch 128/200 | LR: 1.58e-05 | Train Loss: 0.4963 | Val Loss: 0.1633 | Val Acc: 0.8793 | Val F1: 0.8805
2025-09-20 00:48:54,579 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 00:49:43,755 - INFO - Epoch 129/200 | LR: 1.54e-05 | Train Loss: 0.5408 | Val Loss: 0.1597 | Val Acc: 0.8916 | Val F1: 0.8949
2025-09-20 00:49:43,756 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 00:50:32,954 - INFO - Epoch 130/200 | LR: 1.50e-05 | Train Loss: 0.5648 | Val Loss: 0.1530 | Val Acc: 0.9071 | Val F1: 0.9094
2025-09-20 00:50:32,955 - INFO - Validation metric improved (0.898045 --> 0.909400). Saving model...
2025-09-20 00:51:22,196 - INFO - Epoch 131/200 | LR: 1.47e-05 | Train Loss: 0.5164 | Val Loss: 0.1466 | Val Acc: 0.9071 | Val F1: 0.9090
2025-09-20 00:51:22,197 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:52:11,219 - INFO - Epoch 132/200 | LR: 1.43e-05 | Train Loss: 0.4816 | Val Loss: 0.1558 | Val Acc: 0.9133 | Val F1: 0.9142
2025-09-20 00:52:11,220 - INFO - Validation metric improved (0.909400 --> 0.914195). Saving model...
2025-09-20 00:53:00,468 - INFO - Epoch 133/200 | LR: 1.39e-05 | Train Loss: 0.5133 | Val Loss: 0.1764 | Val Acc: 0.9009 | Val F1: 0.9028
2025-09-20 00:53:00,469 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 00:53:49,463 - INFO - Epoch 134/200 | LR: 1.35e-05 | Train Loss: 0.4757 | Val Loss: 0.1405 | Val Acc: 0.9040 | Val F1: 0.9057
2025-09-20 00:53:49,465 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 00:54:38,708 - INFO - Epoch 135/200 | LR: 1.32e-05 | Train Loss: 0.4844 | Val Loss: 0.1465 | Val Acc: 0.9102 | Val F1: 0.9128
2025-09-20 00:54:38,710 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 00:55:27,981 - INFO - Epoch 136/200 | LR: 1.28e-05 | Train Loss: 0.5963 | Val Loss: 0.1570 | Val Acc: 0.8978 | Val F1: 0.8992
2025-09-20 00:55:27,982 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 00:56:17,243 - INFO - Epoch 137/200 | LR: 1.25e-05 | Train Loss: 0.4996 | Val Loss: 0.1475 | Val Acc: 0.9102 | Val F1: 0.9112
2025-09-20 00:56:17,244 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 00:57:06,735 - INFO - Epoch 138/200 | LR: 1.21e-05 | Train Loss: 0.5416 | Val Loss: 0.1889 | Val Acc: 0.8978 | Val F1: 0.8982
2025-09-20 00:57:06,736 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 00:57:56,064 - INFO - Epoch 139/200 | LR: 1.18e-05 | Train Loss: 0.5031 | Val Loss: 0.1542 | Val Acc: 0.8947 | Val F1: 0.8961
2025-09-20 00:57:56,065 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 00:58:45,599 - INFO - Epoch 140/200 | LR: 1.14e-05 | Train Loss: 0.4548 | Val Loss: 0.1686 | Val Acc: 0.9040 | Val F1: 0.9038
2025-09-20 00:58:45,601 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 00:59:34,942 - INFO - Epoch 141/200 | LR: 1.11e-05 | Train Loss: 0.4109 | Val Loss: 0.1724 | Val Acc: 0.8916 | Val F1: 0.8899
2025-09-20 00:59:34,943 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 01:00:24,390 - INFO - Epoch 142/200 | LR: 1.07e-05 | Train Loss: 0.4958 | Val Loss: 0.1696 | Val Acc: 0.8916 | Val F1: 0.8931
2025-09-20 01:00:24,392 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 01:01:13,859 - INFO - Epoch 143/200 | LR: 1.04e-05 | Train Loss: 0.5171 | Val Loss: 0.1478 | Val Acc: 0.9009 | Val F1: 0.9017
2025-09-20 01:01:13,860 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 01:02:02,893 - INFO - Epoch 144/200 | LR: 1.01e-05 | Train Loss: 0.5030 | Val Loss: 0.1447 | Val Acc: 0.8824 | Val F1: 0.8824
2025-09-20 01:02:02,894 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 01:02:52,265 - INFO - Epoch 145/200 | LR: 9.73e-06 | Train Loss: 0.5920 | Val Loss: 0.1426 | Val Acc: 0.8916 | Val F1: 0.8920
2025-09-20 01:02:52,266 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 01:03:41,804 - INFO - Epoch 146/200 | LR: 9.40e-06 | Train Loss: 0.5162 | Val Loss: 0.1541 | Val Acc: 0.9040 | Val F1: 0.9034
2025-09-20 01:03:41,805 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 01:04:31,107 - INFO - Epoch 147/200 | LR: 9.08e-06 | Train Loss: 0.5209 | Val Loss: 0.1467 | Val Acc: 0.9009 | Val F1: 0.9013
2025-09-20 01:04:31,108 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 01:05:20,293 - INFO - Epoch 148/200 | LR: 8.77e-06 | Train Loss: 0.4998 | Val Loss: 0.1350 | Val Acc: 0.9040 | Val F1: 0.9057
2025-09-20 01:05:20,294 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 01:06:09,498 - INFO - Epoch 149/200 | LR: 8.46e-06 | Train Loss: 0.5116 | Val Loss: 0.1521 | Val Acc: 0.8916 | Val F1: 0.8936
2025-09-20 01:06:09,499 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 01:06:58,690 - INFO - Epoch 150/200 | LR: 8.15e-06 | Train Loss: 0.5088 | Val Loss: 0.1562 | Val Acc: 0.8854 | Val F1: 0.8849
2025-09-20 01:06:58,691 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 01:07:47,567 - INFO - Epoch 151/200 | LR: 7.85e-06 | Train Loss: 0.5550 | Val Loss: 0.1403 | Val Acc: 0.8916 | Val F1: 0.8937
2025-09-20 01:07:47,568 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 01:08:36,653 - INFO - Epoch 152/200 | LR: 7.55e-06 | Train Loss: 0.5382 | Val Loss: 0.1596 | Val Acc: 0.9040 | Val F1: 0.9050
2025-09-20 01:08:36,655 - INFO - EarlyStopping counter: 20 / 40
2025-09-20 01:09:25,658 - INFO - Epoch 153/200 | LR: 7.26e-06 | Train Loss: 0.5226 | Val Loss: 0.1588 | Val Acc: 0.8916 | Val F1: 0.8931
2025-09-20 01:09:25,660 - INFO - EarlyStopping counter: 21 / 40
2025-09-20 01:10:15,108 - INFO - Epoch 154/200 | LR: 6.98e-06 | Train Loss: 0.4693 | Val Loss: 0.1449 | Val Acc: 0.9040 | Val F1: 0.9052
2025-09-20 01:10:15,108 - INFO - EarlyStopping counter: 22 / 40
2025-09-20 01:11:04,592 - INFO - Epoch 155/200 | LR: 6.69e-06 | Train Loss: 0.4940 | Val Loss: 0.1467 | Val Acc: 0.8978 | Val F1: 0.8984
2025-09-20 01:11:04,594 - INFO - EarlyStopping counter: 23 / 40
2025-09-20 01:11:53,943 - INFO - Epoch 156/200 | LR: 6.42e-06 | Train Loss: 0.4499 | Val Loss: 0.1679 | Val Acc: 0.8885 | Val F1: 0.8904
2025-09-20 01:11:53,944 - INFO - EarlyStopping counter: 24 / 40
2025-09-20 01:12:43,076 - INFO - Epoch 157/200 | LR: 6.15e-06 | Train Loss: 0.4265 | Val Loss: 0.1500 | Val Acc: 0.8978 | Val F1: 0.8986
2025-09-20 01:12:43,077 - INFO - EarlyStopping counter: 25 / 40
2025-09-20 01:13:32,520 - INFO - Epoch 158/200 | LR: 5.88e-06 | Train Loss: 0.5111 | Val Loss: 0.1461 | Val Acc: 0.8916 | Val F1: 0.8917
2025-09-20 01:13:32,521 - INFO - EarlyStopping counter: 26 / 40
2025-09-20 01:14:21,641 - INFO - Epoch 159/200 | LR: 5.62e-06 | Train Loss: 0.5001 | Val Loss: 0.1470 | Val Acc: 0.9071 | Val F1: 0.9070
2025-09-20 01:14:21,642 - INFO - EarlyStopping counter: 27 / 40
2025-09-20 01:15:10,665 - INFO - Epoch 160/200 | LR: 5.36e-06 | Train Loss: 0.4662 | Val Loss: 0.1348 | Val Acc: 0.9164 | Val F1: 0.9174
2025-09-20 01:15:10,667 - INFO - Validation metric improved (0.914195 --> 0.917388). Saving model...
2025-09-20 01:16:00,062 - INFO - Epoch 161/200 | LR: 5.11e-06 | Train Loss: 0.4748 | Val Loss: 0.1596 | Val Acc: 0.9071 | Val F1: 0.9068
2025-09-20 01:16:00,063 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 01:16:48,681 - INFO - Epoch 162/200 | LR: 4.87e-06 | Train Loss: 0.5621 | Val Loss: 0.1472 | Val Acc: 0.9164 | Val F1: 0.9178
2025-09-20 01:16:48,682 - INFO - Validation metric improved (0.917388 --> 0.917811). Saving model...
2025-09-20 01:17:37,954 - INFO - Epoch 163/200 | LR: 4.63e-06 | Train Loss: 0.5321 | Val Loss: 0.1560 | Val Acc: 0.8978 | Val F1: 0.8980
2025-09-20 01:17:37,955 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 01:18:27,193 - INFO - Epoch 164/200 | LR: 4.39e-06 | Train Loss: 0.4786 | Val Loss: 0.1664 | Val Acc: 0.8885 | Val F1: 0.8902
2025-09-20 01:18:27,194 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 01:19:16,233 - INFO - Epoch 165/200 | LR: 4.16e-06 | Train Loss: 0.5575 | Val Loss: 0.1628 | Val Acc: 0.8978 | Val F1: 0.8987
2025-09-20 01:19:16,234 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 01:20:05,537 - INFO - Epoch 166/200 | LR: 3.94e-06 | Train Loss: 0.4807 | Val Loss: 0.1602 | Val Acc: 0.8978 | Val F1: 0.8981
2025-09-20 01:20:05,538 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 01:20:54,963 - INFO - Epoch 167/200 | LR: 3.72e-06 | Train Loss: 0.5073 | Val Loss: 0.1577 | Val Acc: 0.9040 | Val F1: 0.9041
2025-09-20 01:20:54,964 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 01:21:43,960 - INFO - Epoch 168/200 | LR: 3.51e-06 | Train Loss: 0.5377 | Val Loss: 0.1601 | Val Acc: 0.9071 | Val F1: 0.9074
2025-09-20 01:21:43,962 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 01:22:33,539 - INFO - Epoch 169/200 | LR: 3.31e-06 | Train Loss: 0.5298 | Val Loss: 0.1671 | Val Acc: 0.8947 | Val F1: 0.8969
2025-09-20 01:22:33,540 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 01:23:22,670 - INFO - Epoch 170/200 | LR: 3.11e-06 | Train Loss: 0.5261 | Val Loss: 0.1599 | Val Acc: 0.9040 | Val F1: 0.9050
2025-09-20 01:23:22,671 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 01:24:11,971 - INFO - Epoch 171/200 | LR: 2.91e-06 | Train Loss: 0.5043 | Val Loss: 0.1635 | Val Acc: 0.9009 | Val F1: 0.9015
2025-09-20 01:24:11,972 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 01:25:01,161 - INFO - Epoch 172/200 | LR: 2.73e-06 | Train Loss: 0.4449 | Val Loss: 0.1660 | Val Acc: 0.8978 | Val F1: 0.8983
2025-09-20 01:25:01,162 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 01:25:50,333 - INFO - Epoch 173/200 | LR: 2.55e-06 | Train Loss: 0.5088 | Val Loss: 0.1645 | Val Acc: 0.9009 | Val F1: 0.9010
2025-09-20 01:25:50,334 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 01:26:39,486 - INFO - Epoch 174/200 | LR: 2.37e-06 | Train Loss: 0.4470 | Val Loss: 0.1614 | Val Acc: 0.8978 | Val F1: 0.8972
2025-09-20 01:26:39,487 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 01:27:28,676 - INFO - Epoch 175/200 | LR: 2.20e-06 | Train Loss: 0.4649 | Val Loss: 0.1505 | Val Acc: 0.9040 | Val F1: 0.9054
2025-09-20 01:27:28,677 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 01:28:17,924 - INFO - Epoch 176/200 | LR: 2.04e-06 | Train Loss: 0.5014 | Val Loss: 0.1525 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:28:17,925 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 01:29:06,919 - INFO - Epoch 177/200 | LR: 1.88e-06 | Train Loss: 0.4853 | Val Loss: 0.1517 | Val Acc: 0.9164 | Val F1: 0.9174
2025-09-20 01:29:06,921 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 01:29:56,101 - INFO - Epoch 178/200 | LR: 1.73e-06 | Train Loss: 0.5289 | Val Loss: 0.1513 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:29:56,102 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 01:30:45,285 - INFO - Epoch 179/200 | LR: 1.59e-06 | Train Loss: 0.4699 | Val Loss: 0.1506 | Val Acc: 0.9071 | Val F1: 0.9083
2025-09-20 01:30:45,286 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 01:31:34,604 - INFO - Epoch 180/200 | LR: 1.45e-06 | Train Loss: 0.5470 | Val Loss: 0.1536 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:31:34,605 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 01:32:23,496 - INFO - Epoch 181/200 | LR: 1.32e-06 | Train Loss: 0.4121 | Val Loss: 0.1515 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:32:23,497 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 01:33:12,466 - INFO - Epoch 182/200 | LR: 1.20e-06 | Train Loss: 0.4606 | Val Loss: 0.1531 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:33:12,467 - INFO - EarlyStopping counter: 20 / 40
2025-09-20 01:34:01,487 - INFO - Epoch 183/200 | LR: 1.08e-06 | Train Loss: 0.4684 | Val Loss: 0.1555 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:34:01,488 - INFO - EarlyStopping counter: 21 / 40
2025-09-20 01:34:50,763 - INFO - Epoch 184/200 | LR: 9.68e-07 | Train Loss: 0.4659 | Val Loss: 0.1554 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:34:50,764 - INFO - EarlyStopping counter: 22 / 40
2025-09-20 01:35:39,866 - INFO - Epoch 185/200 | LR: 8.63e-07 | Train Loss: 0.4389 | Val Loss: 0.1525 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:35:39,867 - INFO - EarlyStopping counter: 23 / 40
2025-09-20 01:36:29,054 - INFO - Epoch 186/200 | LR: 7.66e-07 | Train Loss: 0.5161 | Val Loss: 0.1517 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:36:29,056 - INFO - EarlyStopping counter: 24 / 40
2025-09-20 01:37:18,355 - INFO - Epoch 187/200 | LR: 6.74e-07 | Train Loss: 0.4785 | Val Loss: 0.1557 | Val Acc: 0.9071 | Val F1: 0.9078
2025-09-20 01:37:18,356 - INFO - EarlyStopping counter: 25 / 40
2025-09-20 01:38:07,615 - INFO - Epoch 188/200 | LR: 5.90e-07 | Train Loss: 0.4768 | Val Loss: 0.1569 | Val Acc: 0.9071 | Val F1: 0.9078
2025-09-20 01:38:07,616 - INFO - EarlyStopping counter: 26 / 40
2025-09-20 01:38:56,767 - INFO - Epoch 189/200 | LR: 5.12e-07 | Train Loss: 0.4745 | Val Loss: 0.1569 | Val Acc: 0.9009 | Val F1: 0.9020
2025-09-20 01:38:56,768 - INFO - EarlyStopping counter: 27 / 40
2025-09-20 01:39:46,116 - INFO - Epoch 190/200 | LR: 4.40e-07 | Train Loss: 0.5219 | Val Loss: 0.1557 | Val Acc: 0.9071 | Val F1: 0.9077
2025-09-20 01:39:46,117 - INFO - EarlyStopping counter: 28 / 40
2025-09-20 01:40:35,211 - INFO - Epoch 191/200 | LR: 3.76e-07 | Train Loss: 0.4422 | Val Loss: 0.1553 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:40:35,212 - INFO - EarlyStopping counter: 29 / 40
2025-09-20 01:41:24,206 - INFO - Epoch 192/200 | LR: 3.18e-07 | Train Loss: 0.4464 | Val Loss: 0.1549 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:41:24,206 - INFO - EarlyStopping counter: 30 / 40
2025-09-20 01:42:13,305 - INFO - Epoch 193/200 | LR: 2.67e-07 | Train Loss: 0.4782 | Val Loss: 0.1547 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:42:13,306 - INFO - EarlyStopping counter: 31 / 40
2025-09-20 01:43:02,495 - INFO - Epoch 194/200 | LR: 2.23e-07 | Train Loss: 0.4234 | Val Loss: 0.1555 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:43:02,497 - INFO - EarlyStopping counter: 32 / 40
2025-09-20 01:43:51,510 - INFO - Epoch 195/200 | LR: 1.85e-07 | Train Loss: 0.4530 | Val Loss: 0.1548 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:43:51,511 - INFO - EarlyStopping counter: 33 / 40
2025-09-20 01:44:40,738 - INFO - Epoch 196/200 | LR: 1.55e-07 | Train Loss: 0.4916 | Val Loss: 0.1547 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:44:40,739 - INFO - EarlyStopping counter: 34 / 40
2025-09-20 01:45:29,768 - INFO - Epoch 197/200 | LR: 1.31e-07 | Train Loss: 0.5315 | Val Loss: 0.1549 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:45:29,768 - INFO - EarlyStopping counter: 35 / 40
2025-09-20 01:46:18,957 - INFO - Epoch 198/200 | LR: 1.14e-07 | Train Loss: 0.4772 | Val Loss: 0.1552 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 01:46:18,958 - INFO - EarlyStopping counter: 36 / 40
2025-09-20 01:47:08,104 - INFO - Epoch 199/200 | LR: 1.03e-07 | Train Loss: 0.4670 | Val Loss: 0.1553 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:47:08,105 - INFO - EarlyStopping counter: 37 / 40
2025-09-20 01:47:57,253 - INFO - Epoch 200/200 | LR: 1.00e-07 | Train Loss: 0.5042 | Val Loss: 0.1550 | Val Acc: 0.9133 | Val F1: 0.9144
2025-09-20 01:47:57,254 - INFO - EarlyStopping counter: 38 / 40
2025-09-20 01:47:57,254 - INFO - Loading best performing model from: results/best_model_27_Exp_V18_Hybrid_Sparsity02.pth
2025-09-20 01:47:57,472 - INFO - 
========================= Starting Full Evaluation of Final Model: 27_Exp_V18_Hybrid_Sparsity02 (Single Model with TTA) =========================
2025-09-20 01:48:15,782 - INFO - 
Final Model Performance Summary - 27_Exp_V18_Hybrid_Sparsity02
  - Final Test Set Accuracy (Single Model + TTA): 91.4815%
  - Final Test Set F1-Score (Macro, Single Model + TTA): 91.2892%
2025-09-20 01:48:18,537 - INFO - Confusion matrix plot saved to: results/confusion_matrix_27_Exp_V18_Hybrid_Sparsity02.png
2025-09-20 01:48:18,540 - INFO - Creating a single train/validation split based on subject IDs...
2025-09-20 01:48:18,540 - INFO - 
========================= Running Experiment: 28_Exp_V17_Hybrid_Sparsity03 =========================
2025-09-20 01:48:18,761 - INFO - Model initialization check passed. All parameters are finite.
2025-09-20 01:49:07,493 - INFO - Epoch 1/200 | LR: 1.00e-05 | Train Loss: 2.6295 | Val Loss: 2.0491 | Val Acc: 0.1920 | Val F1: 0.1296
2025-09-20 01:49:07,494 - INFO - Validation metric improved (-inf --> 0.129583). Saving model...
2025-09-20 01:49:56,446 - INFO - Epoch 2/200 | LR: 1.50e-05 | Train Loss: 2.2017 | Val Loss: 1.9480 | Val Acc: 0.1486 | Val F1: 0.0838
2025-09-20 01:49:56,447 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 01:50:45,253 - INFO - Epoch 3/200 | LR: 2.00e-05 | Train Loss: 1.9765 | Val Loss: 1.5223 | Val Acc: 0.3096 | Val F1: 0.1916
2025-09-20 01:50:45,254 - INFO - Validation metric improved (0.129583 --> 0.191599). Saving model...
2025-09-20 01:51:34,209 - INFO - Epoch 4/200 | LR: 2.50e-05 | Train Loss: 1.8028 | Val Loss: 1.4488 | Val Acc: 0.3220 | Val F1: 0.2466
2025-09-20 01:51:34,210 - INFO - Validation metric improved (0.191599 --> 0.246607). Saving model...
2025-09-20 01:52:23,262 - INFO - Epoch 5/200 | LR: 3.00e-05 | Train Loss: 1.7101 | Val Loss: 1.2441 | Val Acc: 0.4056 | Val F1: 0.3534
2025-09-20 01:52:23,263 - INFO - Validation metric improved (0.246607 --> 0.353393). Saving model...
2025-09-20 01:53:12,090 - INFO - Epoch 6/200 | LR: 3.50e-05 | Train Loss: 1.6154 | Val Loss: 0.9636 | Val Acc: 0.5387 | Val F1: 0.5235
2025-09-20 01:53:12,091 - INFO - Validation metric improved (0.353393 --> 0.523503). Saving model...
2025-09-20 01:54:00,959 - INFO - Epoch 7/200 | LR: 4.00e-05 | Train Loss: 1.5374 | Val Loss: 0.8802 | Val Acc: 0.6099 | Val F1: 0.5736
2025-09-20 01:54:00,960 - INFO - Validation metric improved (0.523503 --> 0.573642). Saving model...
2025-09-20 01:54:50,074 - INFO - Epoch 8/200 | LR: 4.50e-05 | Train Loss: 1.4948 | Val Loss: 0.9567 | Val Acc: 0.4830 | Val F1: 0.4519
2025-09-20 01:54:50,075 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 01:55:38,782 - INFO - Epoch 9/200 | LR: 5.00e-05 | Train Loss: 1.4420 | Val Loss: 0.7250 | Val Acc: 0.6471 | Val F1: 0.6473
2025-09-20 01:55:38,783 - INFO - Validation metric improved (0.573642 --> 0.647307). Saving model...
2025-09-20 01:56:28,116 - INFO - Epoch 10/200 | LR: 5.00e-05 | Train Loss: 1.3795 | Val Loss: 0.8169 | Val Acc: 0.5882 | Val F1: 0.5909
2025-09-20 01:56:28,117 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 01:57:16,883 - INFO - Epoch 11/200 | LR: 5.00e-05 | Train Loss: 1.2929 | Val Loss: 0.8625 | Val Acc: 0.5728 | Val F1: 0.5358
2025-09-20 01:57:16,884 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 01:58:05,603 - INFO - Epoch 12/200 | LR: 5.00e-05 | Train Loss: 1.3101 | Val Loss: 0.6259 | Val Acc: 0.6099 | Val F1: 0.5726
2025-09-20 01:58:05,604 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 01:58:54,245 - INFO - Epoch 13/200 | LR: 5.00e-05 | Train Loss: 1.1911 | Val Loss: 0.6866 | Val Acc: 0.6192 | Val F1: 0.5840
2025-09-20 01:58:54,247 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 01:59:42,886 - INFO - Epoch 14/200 | LR: 4.99e-05 | Train Loss: 1.2242 | Val Loss: 0.6805 | Val Acc: 0.5604 | Val F1: 0.5276
2025-09-20 01:59:42,886 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:00:31,537 - INFO - Epoch 15/200 | LR: 4.99e-05 | Train Loss: 1.1858 | Val Loss: 0.5495 | Val Acc: 0.6347 | Val F1: 0.6069
2025-09-20 02:00:31,538 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:01:20,210 - INFO - Epoch 16/200 | LR: 4.99e-05 | Train Loss: 1.2019 | Val Loss: 0.5995 | Val Acc: 0.6625 | Val F1: 0.6487
2025-09-20 02:01:20,211 - INFO - Validation metric improved (0.647307 --> 0.648702). Saving model...
2025-09-20 02:02:09,216 - INFO - Epoch 17/200 | LR: 4.98e-05 | Train Loss: 1.0861 | Val Loss: 0.5180 | Val Acc: 0.7307 | Val F1: 0.7084
2025-09-20 02:02:09,217 - INFO - Validation metric improved (0.648702 --> 0.708429). Saving model...
2025-09-20 02:02:58,222 - INFO - Epoch 18/200 | LR: 4.98e-05 | Train Loss: 1.1550 | Val Loss: 0.6506 | Val Acc: 0.6223 | Val F1: 0.6230
2025-09-20 02:02:58,223 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:03:47,150 - INFO - Epoch 19/200 | LR: 4.97e-05 | Train Loss: 1.0512 | Val Loss: 0.5186 | Val Acc: 0.7337 | Val F1: 0.7222
2025-09-20 02:03:47,151 - INFO - Validation metric improved (0.708429 --> 0.722164). Saving model...
2025-09-20 02:04:36,133 - INFO - Epoch 20/200 | LR: 4.97e-05 | Train Loss: 1.1082 | Val Loss: 0.5236 | Val Acc: 0.6842 | Val F1: 0.6779
2025-09-20 02:04:36,134 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:05:24,896 - INFO - Epoch 21/200 | LR: 4.96e-05 | Train Loss: 1.1052 | Val Loss: 0.4808 | Val Acc: 0.7059 | Val F1: 0.6748
2025-09-20 02:05:24,897 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:06:13,678 - INFO - Epoch 22/200 | LR: 4.95e-05 | Train Loss: 1.1076 | Val Loss: 0.5349 | Val Acc: 0.7152 | Val F1: 0.7045
2025-09-20 02:06:13,678 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:07:02,281 - INFO - Epoch 23/200 | LR: 4.94e-05 | Train Loss: 1.1235 | Val Loss: 0.4676 | Val Acc: 0.7090 | Val F1: 0.6919
2025-09-20 02:07:02,282 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:07:51,199 - INFO - Epoch 24/200 | LR: 4.93e-05 | Train Loss: 1.0464 | Val Loss: 0.4367 | Val Acc: 0.7461 | Val F1: 0.7456
2025-09-20 02:07:51,200 - INFO - Validation metric improved (0.722164 --> 0.745577). Saving model...
2025-09-20 02:08:40,336 - INFO - Epoch 25/200 | LR: 4.92e-05 | Train Loss: 1.0088 | Val Loss: 0.5606 | Val Acc: 0.6594 | Val F1: 0.6475
2025-09-20 02:08:40,338 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:09:29,050 - INFO - Epoch 26/200 | LR: 4.91e-05 | Train Loss: 1.0158 | Val Loss: 0.4995 | Val Acc: 0.7430 | Val F1: 0.7336
2025-09-20 02:09:29,051 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:10:17,529 - INFO - Epoch 27/200 | LR: 4.90e-05 | Train Loss: 0.9730 | Val Loss: 0.4259 | Val Acc: 0.7307 | Val F1: 0.7066
2025-09-20 02:10:17,530 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:11:06,211 - INFO - Epoch 28/200 | LR: 4.89e-05 | Train Loss: 1.0508 | Val Loss: 0.4444 | Val Acc: 0.7059 | Val F1: 0.6927
2025-09-20 02:11:06,212 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:11:54,807 - INFO - Epoch 29/200 | LR: 4.88e-05 | Train Loss: 1.0036 | Val Loss: 0.4270 | Val Acc: 0.7368 | Val F1: 0.7217
2025-09-20 02:11:54,808 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:12:43,542 - INFO - Epoch 30/200 | LR: 4.86e-05 | Train Loss: 1.0178 | Val Loss: 0.4373 | Val Acc: 0.7183 | Val F1: 0.7095
2025-09-20 02:12:43,543 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:13:32,354 - INFO - Epoch 31/200 | LR: 4.85e-05 | Train Loss: 0.9447 | Val Loss: 0.3449 | Val Acc: 0.7647 | Val F1: 0.7504
2025-09-20 02:13:32,355 - INFO - Validation metric improved (0.745577 --> 0.750448). Saving model...
2025-09-20 02:14:21,507 - INFO - Epoch 32/200 | LR: 4.84e-05 | Train Loss: 0.9109 | Val Loss: 0.3449 | Val Acc: 0.8142 | Val F1: 0.8061
2025-09-20 02:14:21,508 - INFO - Validation metric improved (0.750448 --> 0.806108). Saving model...
2025-09-20 02:15:10,516 - INFO - Epoch 33/200 | LR: 4.82e-05 | Train Loss: 0.8760 | Val Loss: 0.4404 | Val Acc: 0.7554 | Val F1: 0.7238
2025-09-20 02:15:10,518 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:15:59,298 - INFO - Epoch 34/200 | LR: 4.81e-05 | Train Loss: 0.9883 | Val Loss: 0.3518 | Val Acc: 0.7895 | Val F1: 0.7820
2025-09-20 02:15:59,299 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:16:47,876 - INFO - Epoch 35/200 | LR: 4.79e-05 | Train Loss: 0.9155 | Val Loss: 0.3571 | Val Acc: 0.7430 | Val F1: 0.7380
2025-09-20 02:16:47,877 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:17:36,518 - INFO - Epoch 36/200 | LR: 4.77e-05 | Train Loss: 0.8641 | Val Loss: 0.3192 | Val Acc: 0.7678 | Val F1: 0.7710
2025-09-20 02:17:36,519 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:18:25,123 - INFO - Epoch 37/200 | LR: 4.76e-05 | Train Loss: 0.9055 | Val Loss: 0.3119 | Val Acc: 0.7833 | Val F1: 0.7825
2025-09-20 02:18:25,124 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:19:13,592 - INFO - Epoch 38/200 | LR: 4.74e-05 | Train Loss: 0.8343 | Val Loss: 0.3217 | Val Acc: 0.7895 | Val F1: 0.7834
2025-09-20 02:19:13,594 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:20:02,246 - INFO - Epoch 39/200 | LR: 4.72e-05 | Train Loss: 0.9007 | Val Loss: 0.3020 | Val Acc: 0.7957 | Val F1: 0.7949
2025-09-20 02:20:02,247 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 02:20:50,886 - INFO - Epoch 40/200 | LR: 4.70e-05 | Train Loss: 0.8742 | Val Loss: 0.2717 | Val Acc: 0.8111 | Val F1: 0.8073
2025-09-20 02:20:50,887 - INFO - Validation metric improved (0.806108 --> 0.807326). Saving model...
2025-09-20 02:21:39,777 - INFO - Epoch 41/200 | LR: 4.68e-05 | Train Loss: 0.8684 | Val Loss: 0.3720 | Val Acc: 0.7461 | Val F1: 0.7356
2025-09-20 02:21:39,778 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:22:28,411 - INFO - Epoch 42/200 | LR: 4.66e-05 | Train Loss: 0.8750 | Val Loss: 0.3824 | Val Acc: 0.7616 | Val F1: 0.7609
2025-09-20 02:22:28,412 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:23:17,224 - INFO - Epoch 43/200 | LR: 4.64e-05 | Train Loss: 0.8049 | Val Loss: 0.4055 | Val Acc: 0.7554 | Val F1: 0.7588
2025-09-20 02:23:17,225 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:24:05,939 - INFO - Epoch 44/200 | LR: 4.62e-05 | Train Loss: 0.9101 | Val Loss: 0.3194 | Val Acc: 0.7616 | Val F1: 0.7598
2025-09-20 02:24:05,940 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:24:54,555 - INFO - Epoch 45/200 | LR: 4.59e-05 | Train Loss: 0.8861 | Val Loss: 0.3268 | Val Acc: 0.7554 | Val F1: 0.7625
2025-09-20 02:24:54,556 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:25:43,294 - INFO - Epoch 46/200 | LR: 4.57e-05 | Train Loss: 0.8667 | Val Loss: 0.3106 | Val Acc: 0.7988 | Val F1: 0.7997
2025-09-20 02:25:43,295 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:26:31,924 - INFO - Epoch 47/200 | LR: 4.55e-05 | Train Loss: 0.7740 | Val Loss: 0.2740 | Val Acc: 0.8080 | Val F1: 0.8057
2025-09-20 02:26:31,925 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 02:27:20,857 - INFO - Epoch 48/200 | LR: 4.52e-05 | Train Loss: 0.8875 | Val Loss: 0.3935 | Val Acc: 0.7957 | Val F1: 0.7936
2025-09-20 02:27:20,858 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 02:28:09,771 - INFO - Epoch 49/200 | LR: 4.50e-05 | Train Loss: 0.8399 | Val Loss: 0.3573 | Val Acc: 0.7461 | Val F1: 0.7466
2025-09-20 02:28:09,772 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 02:28:58,796 - INFO - Epoch 50/200 | LR: 4.47e-05 | Train Loss: 0.8729 | Val Loss: 0.3500 | Val Acc: 0.7678 | Val F1: 0.7571
2025-09-20 02:28:58,797 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 02:29:47,339 - INFO - Epoch 51/200 | LR: 4.45e-05 | Train Loss: 0.8594 | Val Loss: 0.2883 | Val Acc: 0.8080 | Val F1: 0.8070
2025-09-20 02:29:47,340 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 02:30:35,858 - INFO - Epoch 52/200 | LR: 4.42e-05 | Train Loss: 0.8263 | Val Loss: 0.2877 | Val Acc: 0.8173 | Val F1: 0.8162
2025-09-20 02:30:35,859 - INFO - Validation metric improved (0.807326 --> 0.816232). Saving model...
2025-09-20 02:31:24,730 - INFO - Epoch 53/200 | LR: 4.40e-05 | Train Loss: 0.8140 | Val Loss: 0.2448 | Val Acc: 0.8421 | Val F1: 0.8394
2025-09-20 02:31:24,731 - INFO - Validation metric improved (0.816232 --> 0.839389). Saving model...
2025-09-20 02:32:13,677 - INFO - Epoch 54/200 | LR: 4.37e-05 | Train Loss: 0.7776 | Val Loss: 0.2829 | Val Acc: 0.7957 | Val F1: 0.7819
2025-09-20 02:32:13,678 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:33:02,409 - INFO - Epoch 55/200 | LR: 4.34e-05 | Train Loss: 0.7636 | Val Loss: 0.2654 | Val Acc: 0.8390 | Val F1: 0.8350
2025-09-20 02:33:02,410 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:33:51,197 - INFO - Epoch 56/200 | LR: 4.31e-05 | Train Loss: 0.7208 | Val Loss: 0.3872 | Val Acc: 0.7616 | Val F1: 0.7463
2025-09-20 02:33:51,199 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:34:39,915 - INFO - Epoch 57/200 | LR: 4.28e-05 | Train Loss: 0.7716 | Val Loss: 0.2525 | Val Acc: 0.7895 | Val F1: 0.7886
2025-09-20 02:34:39,916 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:35:28,540 - INFO - Epoch 58/200 | LR: 4.25e-05 | Train Loss: 0.7676 | Val Loss: 0.2945 | Val Acc: 0.7957 | Val F1: 0.7947
2025-09-20 02:35:28,541 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:36:17,325 - INFO - Epoch 59/200 | LR: 4.22e-05 | Train Loss: 0.7071 | Val Loss: 0.3474 | Val Acc: 0.7895 | Val F1: 0.7856
2025-09-20 02:36:17,326 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:37:05,992 - INFO - Epoch 60/200 | LR: 4.19e-05 | Train Loss: 0.7991 | Val Loss: 0.2300 | Val Acc: 0.8638 | Val F1: 0.8659
2025-09-20 02:37:05,993 - INFO - Validation metric improved (0.839389 --> 0.865875). Saving model...
2025-09-20 02:37:54,903 - INFO - Epoch 61/200 | LR: 4.16e-05 | Train Loss: 0.7818 | Val Loss: 0.2710 | Val Acc: 0.8142 | Val F1: 0.8110
2025-09-20 02:37:54,904 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:38:43,503 - INFO - Epoch 62/200 | LR: 4.13e-05 | Train Loss: 0.7805 | Val Loss: 0.2656 | Val Acc: 0.8204 | Val F1: 0.8189
2025-09-20 02:38:43,504 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:39:32,377 - INFO - Epoch 63/200 | LR: 4.10e-05 | Train Loss: 0.7645 | Val Loss: 0.2837 | Val Acc: 0.8080 | Val F1: 0.8021
2025-09-20 02:39:32,378 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:40:20,736 - INFO - Epoch 64/200 | LR: 4.07e-05 | Train Loss: 0.7221 | Val Loss: 0.2866 | Val Acc: 0.8204 | Val F1: 0.8307
2025-09-20 02:40:20,737 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:41:09,275 - INFO - Epoch 65/200 | LR: 4.04e-05 | Train Loss: 0.6537 | Val Loss: 0.2555 | Val Acc: 0.8638 | Val F1: 0.8623
2025-09-20 02:41:09,277 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:41:58,097 - INFO - Epoch 66/200 | LR: 4.00e-05 | Train Loss: 0.7326 | Val Loss: 0.2315 | Val Acc: 0.8483 | Val F1: 0.8516
2025-09-20 02:41:58,098 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:42:46,725 - INFO - Epoch 67/200 | LR: 3.97e-05 | Train Loss: 0.6789 | Val Loss: 0.2584 | Val Acc: 0.8297 | Val F1: 0.8276
2025-09-20 02:42:46,726 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 02:43:35,103 - INFO - Epoch 68/200 | LR: 3.94e-05 | Train Loss: 0.7029 | Val Loss: 0.2103 | Val Acc: 0.8421 | Val F1: 0.8427
2025-09-20 02:43:35,104 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 02:44:23,687 - INFO - Epoch 69/200 | LR: 3.90e-05 | Train Loss: 0.7003 | Val Loss: 0.2339 | Val Acc: 0.8204 | Val F1: 0.8226
2025-09-20 02:44:23,688 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 02:44:36,029 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:44:36,031 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:45:12,344 - INFO - Epoch 70/200 | LR: 3.87e-05 | Train Loss: 0.6853 | Val Loss: 0.2103 | Val Acc: 0.8669 | Val F1: 0.8666
2025-09-20 02:45:12,345 - INFO - Validation metric improved (0.865875 --> 0.866557). Saving model...
2025-09-20 02:46:01,177 - INFO - Epoch 71/200 | LR: 3.83e-05 | Train Loss: 0.7664 | Val Loss: 0.2719 | Val Acc: 0.8204 | Val F1: 0.8262
2025-09-20 02:46:01,178 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:46:49,702 - INFO - Epoch 72/200 | LR: 3.80e-05 | Train Loss: 0.6867 | Val Loss: 0.2106 | Val Acc: 0.8731 | Val F1: 0.8775
2025-09-20 02:46:49,703 - INFO - Validation metric improved (0.866557 --> 0.877506). Saving model...
2025-09-20 02:47:38,687 - INFO - Epoch 73/200 | LR: 3.76e-05 | Train Loss: 0.6532 | Val Loss: 0.2011 | Val Acc: 0.8824 | Val F1: 0.8859
2025-09-20 02:47:38,688 - INFO - Validation metric improved (0.877506 --> 0.885898). Saving model...
2025-09-20 02:48:27,686 - INFO - Epoch 74/200 | LR: 3.73e-05 | Train Loss: 0.6779 | Val Loss: 0.2671 | Val Acc: 0.8297 | Val F1: 0.8311
2025-09-20 02:48:27,687 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:49:16,537 - INFO - Epoch 75/200 | LR: 3.69e-05 | Train Loss: 0.6624 | Val Loss: 0.2774 | Val Acc: 0.8080 | Val F1: 0.8139
2025-09-20 02:49:16,537 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:49:37,555 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:49:37,558 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:50:05,218 - INFO - Epoch 76/200 | LR: 3.66e-05 | Train Loss: 0.6776 | Val Loss: 0.2422 | Val Acc: 0.8390 | Val F1: 0.8424
2025-09-20 02:50:05,219 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:50:30,711 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:50:30,713 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:50:53,860 - INFO - Epoch 77/200 | LR: 3.62e-05 | Train Loss: 0.6504 | Val Loss: 0.2422 | Val Acc: 0.8483 | Val F1: 0.8574
2025-09-20 02:50:53,861 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:51:42,809 - INFO - Epoch 78/200 | LR: 3.58e-05 | Train Loss: 0.6483 | Val Loss: 0.1754 | Val Acc: 0.8978 | Val F1: 0.8996
2025-09-20 02:51:42,810 - INFO - Validation metric improved (0.885898 --> 0.899551). Saving model...
2025-09-20 02:52:31,932 - INFO - Epoch 79/200 | LR: 3.54e-05 | Train Loss: 0.6458 | Val Loss: 0.1627 | Val Acc: 0.8916 | Val F1: 0.8942
2025-09-20 02:52:31,933 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 02:53:20,446 - INFO - Epoch 80/200 | LR: 3.51e-05 | Train Loss: 0.6853 | Val Loss: 0.2197 | Val Acc: 0.8421 | Val F1: 0.8429
2025-09-20 02:53:20,447 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 02:53:36,297 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:53:36,299 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:54:08,983 - INFO - Epoch 81/200 | LR: 3.47e-05 | Train Loss: 0.6709 | Val Loss: 0.2798 | Val Acc: 0.8390 | Val F1: 0.8359
2025-09-20 02:54:08,984 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 02:54:57,611 - INFO - Epoch 82/200 | LR: 3.43e-05 | Train Loss: 0.6419 | Val Loss: 0.2377 | Val Acc: 0.8452 | Val F1: 0.8492
2025-09-20 02:54:57,611 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 02:55:46,345 - INFO - Epoch 83/200 | LR: 3.39e-05 | Train Loss: 0.6113 | Val Loss: 0.2637 | Val Acc: 0.8297 | Val F1: 0.8297
2025-09-20 02:55:46,346 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 02:56:22,359 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:56:22,361 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:56:34,851 - INFO - Epoch 84/200 | LR: 3.35e-05 | Train Loss: 0.6471 | Val Loss: 0.2210 | Val Acc: 0.8390 | Val F1: 0.8406
2025-09-20 02:56:34,853 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 02:56:50,453 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:56:50,455 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:56:52,690 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:56:52,692 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:57:23,065 - INFO - Epoch 85/200 | LR: 3.32e-05 | Train Loss: 0.7178 | Val Loss: 0.2656 | Val Acc: 0.8359 | Val F1: 0.8341
2025-09-20 02:57:23,066 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 02:57:34,819 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:57:34,821 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:58:11,606 - INFO - Epoch 86/200 | LR: 3.28e-05 | Train Loss: 0.5513 | Val Loss: 0.2142 | Val Acc: 0.8545 | Val F1: 0.8577
2025-09-20 02:58:11,607 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 02:58:40,022 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 02:58:40,024 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 02:59:00,263 - INFO - Epoch 87/200 | LR: 3.24e-05 | Train Loss: 0.6554 | Val Loss: 0.2585 | Val Acc: 0.8297 | Val F1: 0.8334
2025-09-20 02:59:00,264 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 02:59:48,928 - INFO - Epoch 88/200 | LR: 3.20e-05 | Train Loss: 0.5828 | Val Loss: 0.2483 | Val Acc: 0.8514 | Val F1: 0.8540
2025-09-20 02:59:48,929 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 03:00:37,641 - INFO - Epoch 89/200 | LR: 3.16e-05 | Train Loss: 0.6126 | Val Loss: 0.2984 | Val Acc: 0.8483 | Val F1: 0.8451
2025-09-20 03:00:37,642 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 03:01:25,934 - INFO - Epoch 90/200 | LR: 3.12e-05 | Train Loss: 0.7122 | Val Loss: 0.1842 | Val Acc: 0.8854 | Val F1: 0.8851
2025-09-20 03:01:25,935 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 03:02:14,668 - INFO - Epoch 91/200 | LR: 3.08e-05 | Train Loss: 0.6592 | Val Loss: 0.1880 | Val Acc: 0.8885 | Val F1: 0.8923
2025-09-20 03:02:14,669 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 03:03:03,525 - INFO - Epoch 92/200 | LR: 3.04e-05 | Train Loss: 0.6077 | Val Loss: 0.1842 | Val Acc: 0.8854 | Val F1: 0.8884
2025-09-20 03:03:03,526 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 03:03:17,343 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 03:03:17,345 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 03:03:51,735 - INFO - Epoch 93/200 | LR: 3.00e-05 | Train Loss: 0.5967 | Val Loss: 0.1995 | Val Acc: 0.8793 | Val F1: 0.8769
2025-09-20 03:03:51,736 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 03:04:40,398 - INFO - Epoch 94/200 | LR: 2.96e-05 | Train Loss: 0.6375 | Val Loss: 0.2233 | Val Acc: 0.8762 | Val F1: 0.8764
2025-09-20 03:04:40,399 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 03:05:28,976 - INFO - Epoch 95/200 | LR: 2.92e-05 | Train Loss: 0.5285 | Val Loss: 0.1839 | Val Acc: 0.8824 | Val F1: 0.8860
2025-09-20 03:05:28,977 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 03:06:17,720 - INFO - Epoch 96/200 | LR: 2.87e-05 | Train Loss: 0.6132 | Val Loss: 0.1948 | Val Acc: 0.8824 | Val F1: 0.8868
2025-09-20 03:06:17,721 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 03:07:06,218 - INFO - Epoch 97/200 | LR: 2.83e-05 | Train Loss: 0.5546 | Val Loss: 0.2054 | Val Acc: 0.8607 | Val F1: 0.8615
2025-09-20 03:07:06,219 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 03:07:54,836 - INFO - Epoch 98/200 | LR: 2.79e-05 | Train Loss: 0.5977 | Val Loss: 0.1968 | Val Acc: 0.8669 | Val F1: 0.8694
2025-09-20 03:07:54,837 - INFO - EarlyStopping counter: 20 / 40
2025-09-20 03:08:43,531 - INFO - Epoch 99/200 | LR: 2.75e-05 | Train Loss: 0.5683 | Val Loss: 0.2258 | Val Acc: 0.8607 | Val F1: 0.8634
2025-09-20 03:08:43,532 - INFO - EarlyStopping counter: 21 / 40
2025-09-20 03:09:32,239 - INFO - Epoch 100/200 | LR: 2.71e-05 | Train Loss: 0.5614 | Val Loss: 0.2560 | Val Acc: 0.8359 | Val F1: 0.8440
2025-09-20 03:09:32,240 - INFO - EarlyStopping counter: 22 / 40
2025-09-20 03:10:21,181 - INFO - Epoch 101/200 | LR: 2.67e-05 | Train Loss: 0.6016 | Val Loss: 0.1825 | Val Acc: 0.8885 | Val F1: 0.8923
2025-09-20 03:10:21,182 - INFO - EarlyStopping counter: 23 / 40
2025-09-20 03:11:09,643 - INFO - Epoch 102/200 | LR: 2.63e-05 | Train Loss: 0.6208 | Val Loss: 0.1668 | Val Acc: 0.8947 | Val F1: 0.9006
2025-09-20 03:11:09,643 - INFO - Validation metric improved (0.899551 --> 0.900551). Saving model...
2025-09-20 03:11:28,997 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 03:11:28,999 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 03:11:39,851 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 03:11:39,853 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 03:11:58,100 - INFO - Epoch 103/200 | LR: 2.59e-05 | Train Loss: 0.5469 | Val Loss: 0.2028 | Val Acc: 0.8854 | Val F1: 0.8901
2025-09-20 03:11:58,100 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 03:12:46,962 - INFO - Epoch 104/200 | LR: 2.55e-05 | Train Loss: 0.5812 | Val Loss: 0.1956 | Val Acc: 0.8731 | Val F1: 0.8765
2025-09-20 03:12:46,962 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 03:13:35,597 - INFO - Epoch 105/200 | LR: 2.51e-05 | Train Loss: 0.5486 | Val Loss: 0.1916 | Val Acc: 0.8793 | Val F1: 0.8826
2025-09-20 03:13:35,598 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 03:14:24,364 - INFO - Epoch 106/200 | LR: 2.46e-05 | Train Loss: 0.5849 | Val Loss: 0.2061 | Val Acc: 0.8700 | Val F1: 0.8737
2025-09-20 03:14:24,366 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 03:15:13,140 - INFO - Epoch 107/200 | LR: 2.42e-05 | Train Loss: 0.5961 | Val Loss: 0.1703 | Val Acc: 0.8731 | Val F1: 0.8779
2025-09-20 03:15:13,141 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 03:16:01,924 - INFO - Epoch 108/200 | LR: 2.38e-05 | Train Loss: 0.6075 | Val Loss: 0.1739 | Val Acc: 0.8762 | Val F1: 0.8807
2025-09-20 03:16:01,925 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 03:16:39,621 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 03:16:39,623 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 03:16:50,318 - INFO - Epoch 109/200 | LR: 2.34e-05 | Train Loss: 0.6463 | Val Loss: 0.1973 | Val Acc: 0.8762 | Val F1: 0.8812
2025-09-20 03:16:50,319 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 03:17:38,960 - INFO - Epoch 110/200 | LR: 2.30e-05 | Train Loss: 0.5570 | Val Loss: 0.1747 | Val Acc: 0.9164 | Val F1: 0.9171
2025-09-20 03:17:38,961 - INFO - Validation metric improved (0.900551 --> 0.917135). Saving model...
2025-09-20 03:18:27,899 - INFO - Epoch 111/200 | LR: 2.26e-05 | Train Loss: 0.5820 | Val Loss: 0.1387 | Val Acc: 0.8947 | Val F1: 0.8993
2025-09-20 03:18:27,900 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 03:19:16,305 - INFO - Epoch 112/200 | LR: 2.22e-05 | Train Loss: 0.5302 | Val Loss: 0.2025 | Val Acc: 0.8700 | Val F1: 0.8716
2025-09-20 03:19:16,306 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 03:20:05,004 - INFO - Epoch 113/200 | LR: 2.18e-05 | Train Loss: 0.5712 | Val Loss: 0.1935 | Val Acc: 0.8916 | Val F1: 0.8939
2025-09-20 03:20:05,005 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 03:20:53,491 - INFO - Epoch 114/200 | LR: 2.14e-05 | Train Loss: 0.4997 | Val Loss: 0.1906 | Val Acc: 0.8731 | Val F1: 0.8772
2025-09-20 03:20:53,492 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 03:21:42,049 - INFO - Epoch 115/200 | LR: 2.09e-05 | Train Loss: 0.6070 | Val Loss: 0.2209 | Val Acc: 0.8731 | Val F1: 0.8787
2025-09-20 03:21:42,050 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 03:22:30,432 - INFO - Epoch 116/200 | LR: 2.05e-05 | Train Loss: 0.5690 | Val Loss: 0.1784 | Val Acc: 0.8854 | Val F1: 0.8903
2025-09-20 03:22:30,433 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 03:23:19,192 - INFO - Epoch 117/200 | LR: 2.01e-05 | Train Loss: 0.5408 | Val Loss: 0.1839 | Val Acc: 0.8793 | Val F1: 0.8833
2025-09-20 03:23:19,193 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 03:24:07,895 - INFO - Epoch 118/200 | LR: 1.97e-05 | Train Loss: 0.6024 | Val Loss: 0.2123 | Val Acc: 0.8359 | Val F1: 0.8399
2025-09-20 03:24:07,896 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 03:24:56,823 - INFO - Epoch 119/200 | LR: 1.93e-05 | Train Loss: 0.4719 | Val Loss: 0.1996 | Val Acc: 0.8669 | Val F1: 0.8719
2025-09-20 03:24:56,824 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 03:25:45,145 - INFO - Epoch 120/200 | LR: 1.89e-05 | Train Loss: 0.5814 | Val Loss: 0.1935 | Val Acc: 0.8854 | Val F1: 0.8891
2025-09-20 03:25:45,146 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 03:26:33,880 - INFO - Epoch 121/200 | LR: 1.85e-05 | Train Loss: 0.5070 | Val Loss: 0.1877 | Val Acc: 0.8885 | Val F1: 0.8935
2025-09-20 03:26:33,881 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 03:27:22,564 - INFO - Epoch 122/200 | LR: 1.81e-05 | Train Loss: 0.5019 | Val Loss: 0.1985 | Val Acc: 0.8731 | Val F1: 0.8771
2025-09-20 03:27:22,565 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 03:28:11,307 - INFO - Epoch 123/200 | LR: 1.77e-05 | Train Loss: 0.6207 | Val Loss: 0.2028 | Val Acc: 0.8669 | Val F1: 0.8729
2025-09-20 03:28:11,308 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 03:29:00,274 - INFO - Epoch 124/200 | LR: 1.73e-05 | Train Loss: 0.4839 | Val Loss: 0.1705 | Val Acc: 0.8824 | Val F1: 0.8866
2025-09-20 03:29:00,275 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 03:29:48,892 - INFO - Epoch 125/200 | LR: 1.69e-05 | Train Loss: 0.5021 | Val Loss: 0.1908 | Val Acc: 0.8854 | Val F1: 0.8888
2025-09-20 03:29:48,893 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 03:30:37,542 - INFO - Epoch 126/200 | LR: 1.66e-05 | Train Loss: 0.5195 | Val Loss: 0.1836 | Val Acc: 0.8793 | Val F1: 0.8823
2025-09-20 03:30:37,543 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 03:31:26,006 - INFO - Epoch 127/200 | LR: 1.62e-05 | Train Loss: 0.5445 | Val Loss: 0.2015 | Val Acc: 0.8978 | Val F1: 0.8997
2025-09-20 03:31:26,007 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 03:32:14,431 - INFO - Epoch 128/200 | LR: 1.58e-05 | Train Loss: 0.5493 | Val Loss: 0.1834 | Val Acc: 0.8854 | Val F1: 0.8883
2025-09-20 03:32:14,432 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 03:33:03,086 - INFO - Epoch 129/200 | LR: 1.54e-05 | Train Loss: 0.5664 | Val Loss: 0.1825 | Val Acc: 0.8700 | Val F1: 0.8735
2025-09-20 03:33:03,087 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 03:33:51,859 - INFO - Epoch 130/200 | LR: 1.50e-05 | Train Loss: 0.4789 | Val Loss: 0.2318 | Val Acc: 0.8638 | Val F1: 0.8694
2025-09-20 03:33:51,860 - INFO - EarlyStopping counter: 20 / 40
2025-09-20 03:34:40,714 - INFO - Epoch 131/200 | LR: 1.47e-05 | Train Loss: 0.4918 | Val Loss: 0.1618 | Val Acc: 0.8947 | Val F1: 0.8985
2025-09-20 03:34:40,715 - INFO - EarlyStopping counter: 21 / 40
2025-09-20 03:35:29,310 - INFO - Epoch 132/200 | LR: 1.43e-05 | Train Loss: 0.4864 | Val Loss: 0.1842 | Val Acc: 0.8824 | Val F1: 0.8874
2025-09-20 03:35:29,311 - INFO - EarlyStopping counter: 22 / 40
2025-09-20 03:36:18,021 - INFO - Epoch 133/200 | LR: 1.39e-05 | Train Loss: 0.5392 | Val Loss: 0.1638 | Val Acc: 0.9102 | Val F1: 0.9118
2025-09-20 03:36:18,022 - INFO - EarlyStopping counter: 23 / 40
2025-09-20 03:37:06,816 - INFO - Epoch 134/200 | LR: 1.35e-05 | Train Loss: 0.4913 | Val Loss: 0.1694 | Val Acc: 0.8978 | Val F1: 0.9000
2025-09-20 03:37:06,817 - INFO - EarlyStopping counter: 24 / 40
2025-09-20 03:37:55,363 - INFO - Epoch 135/200 | LR: 1.32e-05 | Train Loss: 0.5562 | Val Loss: 0.1739 | Val Acc: 0.9040 | Val F1: 0.9069
2025-09-20 03:37:55,363 - INFO - EarlyStopping counter: 25 / 40
2025-09-20 03:38:44,327 - INFO - Epoch 136/200 | LR: 1.28e-05 | Train Loss: 0.4496 | Val Loss: 0.1827 | Val Acc: 0.8793 | Val F1: 0.8846
2025-09-20 03:38:44,329 - INFO - EarlyStopping counter: 26 / 40
2025-09-20 03:39:32,814 - INFO - Epoch 137/200 | LR: 1.25e-05 | Train Loss: 0.5190 | Val Loss: 0.1917 | Val Acc: 0.8669 | Val F1: 0.8704
2025-09-20 03:39:32,815 - INFO - EarlyStopping counter: 27 / 40
2025-09-20 03:40:21,755 - INFO - Epoch 138/200 | LR: 1.21e-05 | Train Loss: 0.4857 | Val Loss: 0.1886 | Val Acc: 0.8824 | Val F1: 0.8848
2025-09-20 03:40:21,755 - INFO - EarlyStopping counter: 28 / 40
2025-09-20 03:41:10,432 - INFO - Epoch 139/200 | LR: 1.18e-05 | Train Loss: 0.5404 | Val Loss: 0.2229 | Val Acc: 0.8545 | Val F1: 0.8575
2025-09-20 03:41:10,433 - INFO - EarlyStopping counter: 29 / 40
2025-09-20 03:41:59,133 - INFO - Epoch 140/200 | LR: 1.14e-05 | Train Loss: 0.5909 | Val Loss: 0.1971 | Val Acc: 0.8824 | Val F1: 0.8862
2025-09-20 03:41:59,134 - INFO - EarlyStopping counter: 30 / 40
2025-09-20 03:42:47,948 - INFO - Epoch 141/200 | LR: 1.11e-05 | Train Loss: 0.5207 | Val Loss: 0.2188 | Val Acc: 0.8824 | Val F1: 0.8868
2025-09-20 03:42:47,949 - INFO - EarlyStopping counter: 31 / 40
2025-09-20 03:43:36,489 - INFO - Epoch 142/200 | LR: 1.07e-05 | Train Loss: 0.5013 | Val Loss: 0.2090 | Val Acc: 0.8978 | Val F1: 0.9019
2025-09-20 03:43:36,490 - INFO - EarlyStopping counter: 32 / 40
2025-09-20 03:44:25,004 - INFO - Epoch 143/200 | LR: 1.04e-05 | Train Loss: 0.5258 | Val Loss: 0.1831 | Val Acc: 0.9009 | Val F1: 0.9040
2025-09-20 03:44:25,005 - INFO - EarlyStopping counter: 33 / 40
2025-09-20 03:45:13,723 - INFO - Epoch 144/200 | LR: 1.01e-05 | Train Loss: 0.4690 | Val Loss: 0.1705 | Val Acc: 0.9009 | Val F1: 0.9034
2025-09-20 03:45:13,724 - INFO - EarlyStopping counter: 34 / 40
2025-09-20 03:46:02,527 - INFO - Epoch 145/200 | LR: 9.73e-06 | Train Loss: 0.5003 | Val Loss: 0.2082 | Val Acc: 0.8885 | Val F1: 0.8926
2025-09-20 03:46:02,528 - INFO - EarlyStopping counter: 35 / 40
2025-09-20 03:46:51,162 - INFO - Epoch 146/200 | LR: 9.40e-06 | Train Loss: 0.4366 | Val Loss: 0.1740 | Val Acc: 0.8947 | Val F1: 0.8988
2025-09-20 03:46:51,164 - INFO - EarlyStopping counter: 36 / 40
2025-09-20 03:47:39,595 - INFO - Epoch 147/200 | LR: 9.08e-06 | Train Loss: 0.5320 | Val Loss: 0.1757 | Val Acc: 0.8793 | Val F1: 0.8842
2025-09-20 03:47:39,596 - INFO - EarlyStopping counter: 37 / 40
2025-09-20 03:48:28,138 - INFO - Epoch 148/200 | LR: 8.77e-06 | Train Loss: 0.5098 | Val Loss: 0.1829 | Val Acc: 0.8947 | Val F1: 0.8986
2025-09-20 03:48:28,140 - INFO - EarlyStopping counter: 38 / 40
2025-09-20 03:49:16,641 - INFO - Epoch 149/200 | LR: 8.46e-06 | Train Loss: 0.5287 | Val Loss: 0.1814 | Val Acc: 0.8978 | Val F1: 0.9002
2025-09-20 03:49:16,642 - INFO - EarlyStopping counter: 39 / 40
2025-09-20 03:50:05,225 - INFO - Epoch 150/200 | LR: 8.15e-06 | Train Loss: 0.5359 | Val Loss: 0.1825 | Val Acc: 0.8978 | Val F1: 0.9017
2025-09-20 03:50:05,226 - INFO - EarlyStopping counter: 40 / 40
2025-09-20 03:50:05,226 - INFO - Early stopping triggered.
2025-09-20 03:50:05,226 - INFO - Loading best performing model from: results/best_model_28_Exp_V17_Hybrid_Sparsity03.pth
2025-09-20 03:50:05,443 - INFO - 
========================= Starting Full Evaluation of Final Model: 28_Exp_V17_Hybrid_Sparsity03 (Single Model with TTA) =========================
2025-09-20 03:50:29,189 - INFO - 
Final Model Performance Summary - 28_Exp_V17_Hybrid_Sparsity03
  - Final Test Set Accuracy (Single Model + TTA): 85.9259%
  - Final Test Set F1-Score (Macro, Single Model + TTA): 85.9579%
2025-09-20 03:50:31,791 - INFO - Confusion matrix plot saved to: results/confusion_matrix_28_Exp_V17_Hybrid_Sparsity03.png
2025-09-20 03:50:31,793 - INFO - Creating a single train/validation split based on subject IDs...
2025-09-20 03:50:31,794 - INFO - 
========================= Running Experiment: 29_Exp_V17_Hybrid_TopK_4 =========================
2025-09-20 03:50:32,017 - INFO - Model initialization check passed. All parameters are finite.
2025-09-20 03:51:20,710 - INFO - Epoch 1/200 | LR: 1.00e-05 | Train Loss: 3.0286 | Val Loss: 2.1300 | Val Acc: 0.1889 | Val F1: 0.1208
2025-09-20 03:51:20,710 - INFO - Validation metric improved (-inf --> 0.120783). Saving model...
2025-09-20 03:52:09,673 - INFO - Epoch 2/200 | LR: 1.50e-05 | Train Loss: 2.2142 | Val Loss: 1.7672 | Val Acc: 0.2198 | Val F1: 0.1427
2025-09-20 03:52:09,674 - INFO - Validation metric improved (0.120783 --> 0.142732). Saving model...
2025-09-20 03:52:58,442 - INFO - Epoch 3/200 | LR: 2.00e-05 | Train Loss: 1.9864 | Val Loss: 1.5517 | Val Acc: 0.2941 | Val F1: 0.2133
2025-09-20 03:52:58,443 - INFO - Validation metric improved (0.142732 --> 0.213252). Saving model...
2025-09-20 03:53:47,590 - INFO - Epoch 4/200 | LR: 2.50e-05 | Train Loss: 1.8619 | Val Loss: 1.4003 | Val Acc: 0.3684 | Val F1: 0.3069
2025-09-20 03:53:47,591 - INFO - Validation metric improved (0.213252 --> 0.306903). Saving model...
2025-09-20 03:54:37,005 - INFO - Epoch 5/200 | LR: 3.00e-05 | Train Loss: 1.7511 | Val Loss: 1.3630 | Val Acc: 0.3437 | Val F1: 0.2816
2025-09-20 03:54:37,006 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 03:55:26,071 - INFO - Epoch 6/200 | LR: 3.50e-05 | Train Loss: 1.6899 | Val Loss: 1.2392 | Val Acc: 0.3715 | Val F1: 0.3014
2025-09-20 03:55:26,072 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 03:56:15,369 - INFO - Epoch 7/200 | LR: 4.00e-05 | Train Loss: 1.5817 | Val Loss: 1.1208 | Val Acc: 0.4025 | Val F1: 0.3203
2025-09-20 03:56:15,371 - INFO - Validation metric improved (0.306903 --> 0.320334). Saving model...
2025-09-20 03:57:04,654 - INFO - Epoch 8/200 | LR: 4.50e-05 | Train Loss: 1.5259 | Val Loss: 1.0514 | Val Acc: 0.4180 | Val F1: 0.3848
2025-09-20 03:57:04,655 - INFO - Validation metric improved (0.320334 --> 0.384813). Saving model...
2025-09-20 03:57:53,968 - INFO - Epoch 9/200 | LR: 5.00e-05 | Train Loss: 1.5365 | Val Loss: 1.0111 | Val Acc: 0.4582 | Val F1: 0.4085
2025-09-20 03:57:53,969 - INFO - Validation metric improved (0.384813 --> 0.408467). Saving model...
2025-09-20 03:58:43,297 - INFO - Epoch 10/200 | LR: 5.00e-05 | Train Loss: 1.4811 | Val Loss: 1.1084 | Val Acc: 0.4087 | Val F1: 0.3753
2025-09-20 03:58:43,298 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 03:59:32,028 - INFO - Epoch 11/200 | LR: 5.00e-05 | Train Loss: 1.4773 | Val Loss: 1.0587 | Val Acc: 0.4799 | Val F1: 0.4279
2025-09-20 03:59:32,029 - INFO - Validation metric improved (0.408467 --> 0.427872). Saving model...
2025-09-20 04:00:21,341 - INFO - Epoch 12/200 | LR: 5.00e-05 | Train Loss: 1.4294 | Val Loss: 0.9170 | Val Acc: 0.4923 | Val F1: 0.4741
2025-09-20 04:00:21,342 - INFO - Validation metric improved (0.427872 --> 0.474052). Saving model...
2025-09-20 04:01:10,636 - INFO - Epoch 13/200 | LR: 5.00e-05 | Train Loss: 1.3273 | Val Loss: 1.0706 | Val Acc: 0.4582 | Val F1: 0.4048
2025-09-20 04:01:10,636 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:01:59,505 - INFO - Epoch 14/200 | LR: 4.99e-05 | Train Loss: 1.3818 | Val Loss: 1.0040 | Val Acc: 0.4737 | Val F1: 0.4564
2025-09-20 04:01:59,507 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:02:48,730 - INFO - Epoch 15/200 | LR: 4.99e-05 | Train Loss: 1.2829 | Val Loss: 0.7615 | Val Acc: 0.5573 | Val F1: 0.5442
2025-09-20 04:02:48,731 - INFO - Validation metric improved (0.474052 --> 0.544199). Saving model...
2025-09-20 04:03:38,029 - INFO - Epoch 16/200 | LR: 4.99e-05 | Train Loss: 1.3055 | Val Loss: 0.7985 | Val Acc: 0.5913 | Val F1: 0.5893
2025-09-20 04:03:38,030 - INFO - Validation metric improved (0.544199 --> 0.589260). Saving model...
2025-09-20 04:04:27,174 - INFO - Epoch 17/200 | LR: 4.98e-05 | Train Loss: 1.3110 | Val Loss: 0.8163 | Val Acc: 0.5542 | Val F1: 0.5328
2025-09-20 04:04:27,175 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:05:16,094 - INFO - Epoch 18/200 | LR: 4.98e-05 | Train Loss: 1.2907 | Val Loss: 0.9388 | Val Acc: 0.4737 | Val F1: 0.4738
2025-09-20 04:05:16,095 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:06:05,225 - INFO - Epoch 19/200 | LR: 4.97e-05 | Train Loss: 1.2984 | Val Loss: 0.8568 | Val Acc: 0.5046 | Val F1: 0.4750
2025-09-20 04:06:05,227 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:06:54,542 - INFO - Epoch 20/200 | LR: 4.97e-05 | Train Loss: 1.2316 | Val Loss: 0.7623 | Val Acc: 0.5789 | Val F1: 0.5529
2025-09-20 04:06:54,543 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:07:43,610 - INFO - Epoch 21/200 | LR: 4.96e-05 | Train Loss: 1.1907 | Val Loss: 0.7175 | Val Acc: 0.6409 | Val F1: 0.6352
2025-09-20 04:07:43,611 - INFO - Validation metric improved (0.589260 --> 0.635166). Saving model...
2025-09-20 04:08:33,070 - INFO - Epoch 22/200 | LR: 4.95e-05 | Train Loss: 1.2348 | Val Loss: 0.6620 | Val Acc: 0.6409 | Val F1: 0.6229
2025-09-20 04:08:33,071 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:09:21,934 - INFO - Epoch 23/200 | LR: 4.94e-05 | Train Loss: 1.1536 | Val Loss: 0.7672 | Val Acc: 0.6192 | Val F1: 0.5721
2025-09-20 04:09:21,935 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:10:11,213 - INFO - Epoch 24/200 | LR: 4.93e-05 | Train Loss: 1.2205 | Val Loss: 0.7295 | Val Acc: 0.6223 | Val F1: 0.6080
2025-09-20 04:10:11,214 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:11:00,365 - INFO - Epoch 25/200 | LR: 4.92e-05 | Train Loss: 1.1161 | Val Loss: 0.5821 | Val Acc: 0.6502 | Val F1: 0.6444
2025-09-20 04:11:00,366 - INFO - Validation metric improved (0.635166 --> 0.644447). Saving model...
2025-09-20 04:11:49,713 - INFO - Epoch 26/200 | LR: 4.91e-05 | Train Loss: 1.1438 | Val Loss: 0.6063 | Val Acc: 0.6440 | Val F1: 0.6298
2025-09-20 04:11:49,714 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:12:38,783 - INFO - Epoch 27/200 | LR: 4.90e-05 | Train Loss: 1.0715 | Val Loss: 0.5066 | Val Acc: 0.6687 | Val F1: 0.6475
2025-09-20 04:12:38,784 - INFO - Validation metric improved (0.644447 --> 0.647549). Saving model...
2025-09-20 04:13:27,942 - INFO - Epoch 28/200 | LR: 4.89e-05 | Train Loss: 1.1150 | Val Loss: 0.4851 | Val Acc: 0.7337 | Val F1: 0.7295
2025-09-20 04:13:27,943 - INFO - Validation metric improved (0.647549 --> 0.729494). Saving model...
2025-09-20 04:14:17,144 - INFO - Epoch 29/200 | LR: 4.88e-05 | Train Loss: 1.0592 | Val Loss: 0.5134 | Val Acc: 0.7059 | Val F1: 0.6896
2025-09-20 04:14:17,145 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:15:06,204 - INFO - Epoch 30/200 | LR: 4.86e-05 | Train Loss: 1.0100 | Val Loss: 0.5913 | Val Acc: 0.6842 | Val F1: 0.6830
2025-09-20 04:15:06,205 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:15:55,250 - INFO - Epoch 31/200 | LR: 4.85e-05 | Train Loss: 1.0577 | Val Loss: 0.4796 | Val Acc: 0.7276 | Val F1: 0.7173
2025-09-20 04:15:55,251 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:16:44,010 - INFO - Epoch 32/200 | LR: 4.84e-05 | Train Loss: 1.0659 | Val Loss: 0.5240 | Val Acc: 0.7183 | Val F1: 0.7018
2025-09-20 04:16:44,011 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:17:33,199 - INFO - Epoch 33/200 | LR: 4.82e-05 | Train Loss: 1.0507 | Val Loss: 0.5266 | Val Acc: 0.7183 | Val F1: 0.7200
2025-09-20 04:17:33,200 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 04:18:22,090 - INFO - Epoch 34/200 | LR: 4.81e-05 | Train Loss: 1.1075 | Val Loss: 0.4662 | Val Acc: 0.7554 | Val F1: 0.7355
2025-09-20 04:18:22,091 - INFO - Validation metric improved (0.729494 --> 0.735527). Saving model...
2025-09-20 04:19:11,362 - INFO - Epoch 35/200 | LR: 4.79e-05 | Train Loss: 1.0059 | Val Loss: 0.4402 | Val Acc: 0.7399 | Val F1: 0.7412
2025-09-20 04:19:11,363 - INFO - Validation metric improved (0.735527 --> 0.741191). Saving model...
2025-09-20 04:20:00,718 - INFO - Epoch 36/200 | LR: 4.77e-05 | Train Loss: 1.0330 | Val Loss: 0.4473 | Val Acc: 0.7307 | Val F1: 0.7227
2025-09-20 04:20:00,719 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:20:49,574 - INFO - Epoch 37/200 | LR: 4.76e-05 | Train Loss: 0.9855 | Val Loss: 0.4551 | Val Acc: 0.7399 | Val F1: 0.7390
2025-09-20 04:20:49,576 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:21:38,690 - INFO - Epoch 38/200 | LR: 4.74e-05 | Train Loss: 0.9877 | Val Loss: 0.3863 | Val Acc: 0.7554 | Val F1: 0.7500
2025-09-20 04:21:38,691 - INFO - Validation metric improved (0.741191 --> 0.750043). Saving model...
2025-09-20 04:22:27,849 - INFO - Epoch 39/200 | LR: 4.72e-05 | Train Loss: 0.9911 | Val Loss: 0.3438 | Val Acc: 0.8019 | Val F1: 0.8043
2025-09-20 04:22:27,850 - INFO - Validation metric improved (0.750043 --> 0.804302). Saving model...
2025-09-20 04:23:17,052 - INFO - Epoch 40/200 | LR: 4.70e-05 | Train Loss: 0.9656 | Val Loss: 0.4058 | Val Acc: 0.7585 | Val F1: 0.7488
2025-09-20 04:23:17,053 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:24:06,316 - INFO - Epoch 41/200 | LR: 4.68e-05 | Train Loss: 0.9369 | Val Loss: 0.4001 | Val Acc: 0.7461 | Val F1: 0.7466
2025-09-20 04:24:06,317 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:24:55,355 - INFO - Epoch 42/200 | LR: 4.66e-05 | Train Loss: 0.8845 | Val Loss: 0.2873 | Val Acc: 0.8421 | Val F1: 0.8437
2025-09-20 04:24:55,356 - INFO - Validation metric improved (0.804302 --> 0.843720). Saving model...
2025-09-20 04:25:29,685 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:25:29,687 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:25:44,513 - INFO - Epoch 43/200 | LR: 4.64e-05 | Train Loss: 0.8261 | Val Loss: 0.2826 | Val Acc: 0.8266 | Val F1: 0.8237
2025-09-20 04:25:44,514 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:26:33,256 - INFO - Epoch 44/200 | LR: 4.62e-05 | Train Loss: 0.8406 | Val Loss: 0.2792 | Val Acc: 0.8080 | Val F1: 0.7985
2025-09-20 04:26:33,257 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:27:22,268 - INFO - Epoch 45/200 | LR: 4.59e-05 | Train Loss: 0.9044 | Val Loss: 0.3659 | Val Acc: 0.7833 | Val F1: 0.7814
2025-09-20 04:27:22,269 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:27:39,353 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:27:39,354 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:28:11,326 - INFO - Epoch 46/200 | LR: 4.57e-05 | Train Loss: 0.8147 | Val Loss: 0.3000 | Val Acc: 0.8080 | Val F1: 0.8056
2025-09-20 04:28:11,328 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:28:24,772 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:28:24,773 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:29:00,079 - INFO - Epoch 47/200 | LR: 4.55e-05 | Train Loss: 0.9464 | Val Loss: 0.3008 | Val Acc: 0.8173 | Val F1: 0.8170
2025-09-20 04:29:00,081 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 04:29:49,101 - INFO - Epoch 48/200 | LR: 4.52e-05 | Train Loss: 0.8720 | Val Loss: 0.2836 | Val Acc: 0.8173 | Val F1: 0.8172
2025-09-20 04:29:49,102 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 04:30:38,005 - INFO - Epoch 49/200 | LR: 4.50e-05 | Train Loss: 0.8708 | Val Loss: 0.2789 | Val Acc: 0.8421 | Val F1: 0.8405
2025-09-20 04:30:38,006 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 04:31:26,946 - INFO - Epoch 50/200 | LR: 4.47e-05 | Train Loss: 0.8550 | Val Loss: 0.3166 | Val Acc: 0.7833 | Val F1: 0.7761
2025-09-20 04:31:26,947 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 04:32:15,938 - INFO - Epoch 51/200 | LR: 4.45e-05 | Train Loss: 0.8347 | Val Loss: 0.3806 | Val Acc: 0.7337 | Val F1: 0.7224
2025-09-20 04:32:15,939 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 04:33:04,921 - INFO - Epoch 52/200 | LR: 4.42e-05 | Train Loss: 0.7943 | Val Loss: 0.2973 | Val Acc: 0.8142 | Val F1: 0.8109
2025-09-20 04:33:04,922 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 04:33:53,951 - INFO - Epoch 53/200 | LR: 4.40e-05 | Train Loss: 0.8114 | Val Loss: 0.2771 | Val Acc: 0.8080 | Val F1: 0.8136
2025-09-20 04:33:53,952 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 04:34:43,038 - INFO - Epoch 54/200 | LR: 4.37e-05 | Train Loss: 0.7904 | Val Loss: 0.2612 | Val Acc: 0.8266 | Val F1: 0.8228
2025-09-20 04:34:43,039 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 04:35:32,309 - INFO - Epoch 55/200 | LR: 4.34e-05 | Train Loss: 0.8043 | Val Loss: 0.2321 | Val Acc: 0.8483 | Val F1: 0.8479
2025-09-20 04:35:32,310 - INFO - Validation metric improved (0.843720 --> 0.847904). Saving model...
2025-09-20 04:36:21,449 - INFO - Epoch 56/200 | LR: 4.31e-05 | Train Loss: 0.8420 | Val Loss: 0.3842 | Val Acc: 0.7833 | Val F1: 0.7801
2025-09-20 04:36:21,450 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:37:10,430 - INFO - Epoch 57/200 | LR: 4.28e-05 | Train Loss: 0.7830 | Val Loss: 0.2405 | Val Acc: 0.8390 | Val F1: 0.8371
2025-09-20 04:37:10,431 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:37:59,485 - INFO - Epoch 58/200 | LR: 4.25e-05 | Train Loss: 0.6328 | Val Loss: 0.2704 | Val Acc: 0.8080 | Val F1: 0.8087
2025-09-20 04:37:59,486 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:38:48,499 - INFO - Epoch 59/200 | LR: 4.22e-05 | Train Loss: 0.7748 | Val Loss: 0.2964 | Val Acc: 0.8421 | Val F1: 0.8453
2025-09-20 04:38:48,500 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:39:37,460 - INFO - Epoch 60/200 | LR: 4.19e-05 | Train Loss: 0.8074 | Val Loss: 0.3604 | Val Acc: 0.7709 | Val F1: 0.7497
2025-09-20 04:39:37,462 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 04:40:26,758 - INFO - Epoch 61/200 | LR: 4.16e-05 | Train Loss: 0.7295 | Val Loss: 0.2675 | Val Acc: 0.8359 | Val F1: 0.8372
2025-09-20 04:40:26,759 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 04:41:15,476 - INFO - Epoch 62/200 | LR: 4.13e-05 | Train Loss: 0.7504 | Val Loss: 0.2282 | Val Acc: 0.8452 | Val F1: 0.8475
2025-09-20 04:41:15,477 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 04:42:04,701 - INFO - Epoch 63/200 | LR: 4.10e-05 | Train Loss: 0.7690 | Val Loss: 0.2331 | Val Acc: 0.8669 | Val F1: 0.8667
2025-09-20 04:42:04,702 - INFO - Validation metric improved (0.847904 --> 0.866705). Saving model...
2025-09-20 04:42:54,046 - INFO - Epoch 64/200 | LR: 4.07e-05 | Train Loss: 0.7148 | Val Loss: 0.2262 | Val Acc: 0.8514 | Val F1: 0.8535
2025-09-20 04:42:54,047 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:43:43,499 - INFO - Epoch 65/200 | LR: 4.04e-05 | Train Loss: 0.7261 | Val Loss: 0.2460 | Val Acc: 0.8359 | Val F1: 0.8389
2025-09-20 04:43:43,500 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:44:32,616 - INFO - Epoch 66/200 | LR: 4.00e-05 | Train Loss: 0.7443 | Val Loss: 0.2633 | Val Acc: 0.8142 | Val F1: 0.8165
2025-09-20 04:44:32,617 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:44:43,631 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:44:43,633 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:44:56,407 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:44:56,409 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:45:21,221 - INFO - Epoch 67/200 | LR: 3.97e-05 | Train Loss: 0.7620 | Val Loss: 0.2193 | Val Acc: 0.8576 | Val F1: 0.8622
2025-09-20 04:45:21,222 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:46:10,332 - INFO - Epoch 68/200 | LR: 3.94e-05 | Train Loss: 0.6706 | Val Loss: 0.2077 | Val Acc: 0.8483 | Val F1: 0.8476
2025-09-20 04:46:10,333 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 04:46:17,113 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:46:17,115 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:46:59,080 - INFO - Epoch 69/200 | LR: 3.90e-05 | Train Loss: 0.6843 | Val Loss: 0.2201 | Val Acc: 0.8700 | Val F1: 0.8692
2025-09-20 04:46:59,081 - INFO - Validation metric improved (0.866705 --> 0.869227). Saving model...
2025-09-20 04:47:29,697 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:47:29,699 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:47:48,067 - INFO - Epoch 70/200 | LR: 3.87e-05 | Train Loss: 0.6744 | Val Loss: 0.2396 | Val Acc: 0.8545 | Val F1: 0.8542
2025-09-20 04:47:48,068 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:48:05,792 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:48:05,794 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:48:14,290 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:48:14,292 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:48:36,441 - INFO - Epoch 71/200 | LR: 3.83e-05 | Train Loss: 0.6309 | Val Loss: 0.2246 | Val Acc: 0.8607 | Val F1: 0.8647
2025-09-20 04:48:36,442 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:49:21,415 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:49:21,417 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:49:25,038 - INFO - Epoch 72/200 | LR: 3.80e-05 | Train Loss: 0.7091 | Val Loss: 0.2230 | Val Acc: 0.8700 | Val F1: 0.8710
2025-09-20 04:49:25,039 - INFO - Validation metric improved (0.869227 --> 0.871030). Saving model...
2025-09-20 04:50:14,517 - INFO - Epoch 73/200 | LR: 3.76e-05 | Train Loss: 0.7500 | Val Loss: 0.1930 | Val Acc: 0.8607 | Val F1: 0.8658
2025-09-20 04:50:14,518 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:50:36,840 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:50:36,842 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:50:38,363 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:50:38,365 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:51:03,078 - INFO - Epoch 74/200 | LR: 3.73e-05 | Train Loss: 0.6313 | Val Loss: 0.2063 | Val Acc: 0.8452 | Val F1: 0.8556
2025-09-20 04:51:03,080 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:51:28,640 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:51:28,642 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:51:51,989 - INFO - Epoch 75/200 | LR: 3.69e-05 | Train Loss: 0.7064 | Val Loss: 0.1803 | Val Acc: 0.8700 | Val F1: 0.8741
2025-09-20 04:51:51,991 - INFO - Validation metric improved (0.871030 --> 0.874098). Saving model...
2025-09-20 04:52:41,199 - INFO - Epoch 76/200 | LR: 3.66e-05 | Train Loss: 0.6055 | Val Loss: 0.2579 | Val Acc: 0.8359 | Val F1: 0.8326
2025-09-20 04:52:41,200 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:53:17,442 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:53:17,444 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:53:29,891 - INFO - Epoch 77/200 | LR: 3.62e-05 | Train Loss: 0.7091 | Val Loss: 0.2359 | Val Acc: 0.8483 | Val F1: 0.8516
2025-09-20 04:53:29,892 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:53:41,719 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:53:41,721 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:54:18,439 - INFO - Epoch 78/200 | LR: 3.58e-05 | Train Loss: 0.6440 | Val Loss: 0.2038 | Val Acc: 0.8916 | Val F1: 0.8920
2025-09-20 04:54:18,440 - INFO - Validation metric improved (0.874098 --> 0.891997). Saving model...
2025-09-20 04:54:44,125 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:54:44,127 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:55:02,825 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:55:02,827 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:55:07,176 - INFO - Epoch 79/200 | LR: 3.54e-05 | Train Loss: 0.6789 | Val Loss: 0.2711 | Val Acc: 0.8514 | Val F1: 0.8514
2025-09-20 04:55:07,177 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 04:55:56,253 - INFO - Epoch 80/200 | LR: 3.51e-05 | Train Loss: 0.7235 | Val Loss: 0.1912 | Val Acc: 0.8731 | Val F1: 0.8763
2025-09-20 04:55:56,254 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 04:56:45,230 - INFO - Epoch 81/200 | LR: 3.47e-05 | Train Loss: 0.6806 | Val Loss: 0.1967 | Val Acc: 0.8700 | Val F1: 0.8718
2025-09-20 04:56:45,231 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 04:57:34,072 - INFO - Epoch 82/200 | LR: 3.43e-05 | Train Loss: 0.6231 | Val Loss: 0.1855 | Val Acc: 0.8885 | Val F1: 0.8908
2025-09-20 04:57:34,073 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 04:58:22,561 - INFO - Epoch 83/200 | LR: 3.39e-05 | Train Loss: 0.5817 | Val Loss: 0.1923 | Val Acc: 0.8731 | Val F1: 0.8761
2025-09-20 04:58:22,563 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 04:59:11,479 - INFO - Epoch 84/200 | LR: 3.35e-05 | Train Loss: 0.6579 | Val Loss: 0.1841 | Val Acc: 0.8947 | Val F1: 0.8949
2025-09-20 04:59:11,480 - INFO - Validation metric improved (0.891997 --> 0.894852). Saving model...
2025-09-20 04:59:23,080 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:59:23,082 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:59:26,022 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 04:59:26,024 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 04:59:59,828 - INFO - Epoch 85/200 | LR: 3.32e-05 | Train Loss: 0.6630 | Val Loss: 0.1738 | Val Acc: 0.8978 | Val F1: 0.9001
2025-09-20 04:59:59,829 - INFO - Validation metric improved (0.894852 --> 0.900084). Saving model...
2025-09-20 05:00:49,424 - INFO - Epoch 86/200 | LR: 3.28e-05 | Train Loss: 0.6308 | Val Loss: 0.1921 | Val Acc: 0.8793 | Val F1: 0.8813
2025-09-20 05:00:49,426 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 05:01:38,273 - INFO - Epoch 87/200 | LR: 3.24e-05 | Train Loss: 0.6745 | Val Loss: 0.1747 | Val Acc: 0.9040 | Val F1: 0.9036
2025-09-20 05:01:38,275 - INFO - Validation metric improved (0.900084 --> 0.903618). Saving model...
2025-09-20 05:01:49,366 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:01:49,368 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:02:27,492 - INFO - Epoch 88/200 | LR: 3.20e-05 | Train Loss: 0.6704 | Val Loss: 0.1979 | Val Acc: 0.8638 | Val F1: 0.8692
2025-09-20 05:02:27,492 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 05:03:16,519 - INFO - Epoch 89/200 | LR: 3.16e-05 | Train Loss: 0.6084 | Val Loss: 0.1577 | Val Acc: 0.8947 | Val F1: 0.8969
2025-09-20 05:03:16,520 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 05:04:05,734 - INFO - Epoch 90/200 | LR: 3.12e-05 | Train Loss: 0.5977 | Val Loss: 0.1449 | Val Acc: 0.9009 | Val F1: 0.9022
2025-09-20 05:04:05,735 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 05:04:55,065 - INFO - Epoch 91/200 | LR: 3.08e-05 | Train Loss: 0.5531 | Val Loss: 0.1378 | Val Acc: 0.8916 | Val F1: 0.8951
2025-09-20 05:04:55,067 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 05:05:44,053 - INFO - Epoch 92/200 | LR: 3.04e-05 | Train Loss: 0.5677 | Val Loss: 0.1245 | Val Acc: 0.9288 | Val F1: 0.9294
2025-09-20 05:05:44,054 - INFO - Validation metric improved (0.903618 --> 0.929446). Saving model...
2025-09-20 05:05:54,387 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:05:54,389 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:06:10,477 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:06:10,479 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:06:33,076 - INFO - Epoch 93/200 | LR: 3.00e-05 | Train Loss: 0.6277 | Val Loss: 0.1513 | Val Acc: 0.8916 | Val F1: 0.8947
2025-09-20 05:06:33,077 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 05:07:22,080 - INFO - Epoch 94/200 | LR: 2.96e-05 | Train Loss: 0.6654 | Val Loss: 0.1463 | Val Acc: 0.9164 | Val F1: 0.9187
2025-09-20 05:07:22,081 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 05:08:11,143 - INFO - Epoch 95/200 | LR: 2.92e-05 | Train Loss: 0.6197 | Val Loss: 0.1627 | Val Acc: 0.9040 | Val F1: 0.9046
2025-09-20 05:08:11,144 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 05:08:59,960 - INFO - Epoch 96/200 | LR: 2.87e-05 | Train Loss: 0.5449 | Val Loss: 0.1600 | Val Acc: 0.9133 | Val F1: 0.9158
2025-09-20 05:08:59,961 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 05:09:48,956 - INFO - Epoch 97/200 | LR: 2.83e-05 | Train Loss: 0.6454 | Val Loss: 0.1755 | Val Acc: 0.9071 | Val F1: 0.9064
2025-09-20 05:09:48,957 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 05:10:09,728 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:10:09,730 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:10:37,950 - INFO - Epoch 98/200 | LR: 2.79e-05 | Train Loss: 0.5142 | Val Loss: 0.1683 | Val Acc: 0.8854 | Val F1: 0.8905
2025-09-20 05:10:37,951 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 05:11:27,086 - INFO - Epoch 99/200 | LR: 2.75e-05 | Train Loss: 0.5888 | Val Loss: 0.1483 | Val Acc: 0.9164 | Val F1: 0.9185
2025-09-20 05:11:27,088 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 05:12:16,028 - INFO - Epoch 100/200 | LR: 2.71e-05 | Train Loss: 0.5376 | Val Loss: 0.1516 | Val Acc: 0.9164 | Val F1: 0.9189
2025-09-20 05:12:16,029 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 05:13:05,062 - INFO - Epoch 101/200 | LR: 2.67e-05 | Train Loss: 0.5439 | Val Loss: 0.1654 | Val Acc: 0.8978 | Val F1: 0.9001
2025-09-20 05:13:05,063 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 05:13:54,180 - INFO - Epoch 102/200 | LR: 2.63e-05 | Train Loss: 0.5665 | Val Loss: 0.1338 | Val Acc: 0.9195 | Val F1: 0.9200
2025-09-20 05:13:54,182 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 05:14:43,205 - INFO - Epoch 103/200 | LR: 2.59e-05 | Train Loss: 0.5761 | Val Loss: 0.1580 | Val Acc: 0.9009 | Val F1: 0.9028
2025-09-20 05:14:43,206 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 05:15:32,428 - INFO - Epoch 104/200 | LR: 2.55e-05 | Train Loss: 0.5711 | Val Loss: 0.1468 | Val Acc: 0.8947 | Val F1: 0.8981
2025-09-20 05:15:32,429 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 05:16:21,409 - INFO - Epoch 105/200 | LR: 2.51e-05 | Train Loss: 0.4999 | Val Loss: 0.1278 | Val Acc: 0.9288 | Val F1: 0.9295
2025-09-20 05:16:21,410 - INFO - Validation metric improved (0.929446 --> 0.929528). Saving model...
2025-09-20 05:17:10,583 - INFO - Epoch 106/200 | LR: 2.46e-05 | Train Loss: 0.5914 | Val Loss: 0.1412 | Val Acc: 0.9133 | Val F1: 0.9166
2025-09-20 05:17:10,584 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 05:17:18,604 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:17:18,606 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:17:59,948 - INFO - Epoch 107/200 | LR: 2.42e-05 | Train Loss: 0.5002 | Val Loss: 0.1942 | Val Acc: 0.8793 | Val F1: 0.8849
2025-09-20 05:17:59,949 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 05:18:49,171 - INFO - Epoch 108/200 | LR: 2.38e-05 | Train Loss: 0.4924 | Val Loss: 0.1804 | Val Acc: 0.9102 | Val F1: 0.9113
2025-09-20 05:18:49,172 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 05:19:38,379 - INFO - Epoch 109/200 | LR: 2.34e-05 | Train Loss: 0.6044 | Val Loss: 0.1319 | Val Acc: 0.9381 | Val F1: 0.9397
2025-09-20 05:19:38,381 - INFO - Validation metric improved (0.929528 --> 0.939741). Saving model...
2025-09-20 05:20:27,480 - INFO - Epoch 110/200 | LR: 2.30e-05 | Train Loss: 0.5827 | Val Loss: 0.1406 | Val Acc: 0.9350 | Val F1: 0.9367
2025-09-20 05:20:27,481 - INFO - EarlyStopping counter: 1 / 40
2025-09-20 05:21:16,610 - INFO - Epoch 111/200 | LR: 2.26e-05 | Train Loss: 0.5572 | Val Loss: 0.1442 | Val Acc: 0.9226 | Val F1: 0.9237
2025-09-20 05:21:16,611 - INFO - EarlyStopping counter: 2 / 40
2025-09-20 05:22:05,760 - INFO - Epoch 112/200 | LR: 2.22e-05 | Train Loss: 0.5098 | Val Loss: 0.1512 | Val Acc: 0.9071 | Val F1: 0.9100
2025-09-20 05:22:05,761 - INFO - EarlyStopping counter: 3 / 40
2025-09-20 05:22:54,472 - INFO - Epoch 113/200 | LR: 2.18e-05 | Train Loss: 0.4943 | Val Loss: 0.1690 | Val Acc: 0.9164 | Val F1: 0.9173
2025-09-20 05:22:54,473 - INFO - EarlyStopping counter: 4 / 40
2025-09-20 05:23:31,396 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:23:31,398 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:23:43,134 - INFO - Epoch 114/200 | LR: 2.14e-05 | Train Loss: 0.6008 | Val Loss: 0.1723 | Val Acc: 0.9226 | Val F1: 0.9252
2025-09-20 05:23:43,135 - INFO - EarlyStopping counter: 5 / 40
2025-09-20 05:24:29,138 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:24:29,140 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:24:32,099 - INFO - Epoch 115/200 | LR: 2.09e-05 | Train Loss: 0.5909 | Val Loss: 0.1813 | Val Acc: 0.9009 | Val F1: 0.9003
2025-09-20 05:24:32,100 - INFO - EarlyStopping counter: 6 / 40
2025-09-20 05:25:21,239 - INFO - Epoch 116/200 | LR: 2.05e-05 | Train Loss: 0.5220 | Val Loss: 0.1349 | Val Acc: 0.9319 | Val F1: 0.9337
2025-09-20 05:25:21,240 - INFO - EarlyStopping counter: 7 / 40
2025-09-20 05:26:10,525 - INFO - Epoch 117/200 | LR: 2.01e-05 | Train Loss: 0.5560 | Val Loss: 0.1441 | Val Acc: 0.9195 | Val F1: 0.9215
2025-09-20 05:26:10,526 - INFO - EarlyStopping counter: 8 / 40
2025-09-20 05:26:59,651 - INFO - Epoch 118/200 | LR: 1.97e-05 | Train Loss: 0.5278 | Val Loss: 0.1358 | Val Acc: 0.9257 | Val F1: 0.9279
2025-09-20 05:26:59,652 - INFO - EarlyStopping counter: 9 / 40
2025-09-20 05:27:48,868 - INFO - Epoch 119/200 | LR: 1.93e-05 | Train Loss: 0.5648 | Val Loss: 0.1395 | Val Acc: 0.9164 | Val F1: 0.9186
2025-09-20 05:27:48,869 - INFO - EarlyStopping counter: 10 / 40
2025-09-20 05:27:53,263 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:27:53,265 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:28:37,795 - INFO - Epoch 120/200 | LR: 1.89e-05 | Train Loss: 0.5041 | Val Loss: 0.1422 | Val Acc: 0.9102 | Val F1: 0.9133
2025-09-20 05:28:37,795 - INFO - EarlyStopping counter: 11 / 40
2025-09-20 05:29:27,081 - INFO - Epoch 121/200 | LR: 1.85e-05 | Train Loss: 0.6013 | Val Loss: 0.1333 | Val Acc: 0.9288 | Val F1: 0.9315
2025-09-20 05:29:27,082 - INFO - EarlyStopping counter: 12 / 40
2025-09-20 05:29:53,966 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:29:53,968 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:30:16,792 - INFO - Epoch 122/200 | LR: 1.81e-05 | Train Loss: 0.6103 | Val Loss: 0.1314 | Val Acc: 0.9350 | Val F1: 0.9366
2025-09-20 05:30:16,793 - INFO - EarlyStopping counter: 13 / 40
2025-09-20 05:31:05,869 - INFO - Epoch 123/200 | LR: 1.77e-05 | Train Loss: 0.4349 | Val Loss: 0.1430 | Val Acc: 0.9226 | Val F1: 0.9240
2025-09-20 05:31:05,870 - INFO - EarlyStopping counter: 14 / 40
2025-09-20 05:31:55,096 - INFO - Epoch 124/200 | LR: 1.73e-05 | Train Loss: 0.4736 | Val Loss: 0.1587 | Val Acc: 0.9195 | Val F1: 0.9186
2025-09-20 05:31:55,097 - INFO - EarlyStopping counter: 15 / 40
2025-09-20 05:31:57,604 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:31:57,606 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:32:31,054 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:32:31,056 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:32:31,088 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:32:31,090 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:32:42,709 - INFO - Epoch 125/200 | LR: 1.69e-05 | Train Loss: 0.5585 | Val Loss: 0.1588 | Val Acc: 0.9040 | Val F1: 0.9049
2025-09-20 05:32:42,710 - INFO - EarlyStopping counter: 16 / 40
2025-09-20 05:33:05,378 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:33:05,380 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:33:25,907 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:33:25,909 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:33:31,440 - INFO - Epoch 126/200 | LR: 1.66e-05 | Train Loss: 0.4781 | Val Loss: 0.1457 | Val Acc: 0.9195 | Val F1: 0.9200
2025-09-20 05:33:31,442 - INFO - EarlyStopping counter: 17 / 40
2025-09-20 05:33:48,582 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:33:48,584 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:34:20,517 - INFO - Epoch 127/200 | LR: 1.62e-05 | Train Loss: 0.5764 | Val Loss: 0.1230 | Val Acc: 0.9350 | Val F1: 0.9366
2025-09-20 05:34:20,518 - INFO - EarlyStopping counter: 18 / 40
2025-09-20 05:34:24,148 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:34:24,150 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:34:33,739 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:34:33,741 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:35:09,309 - INFO - Epoch 128/200 | LR: 1.58e-05 | Train Loss: 0.5218 | Val Loss: 0.1197 | Val Acc: 0.9226 | Val F1: 0.9244
2025-09-20 05:35:09,311 - INFO - EarlyStopping counter: 19 / 40
2025-09-20 05:35:58,067 - INFO - Epoch 129/200 | LR: 1.54e-05 | Train Loss: 0.5362 | Val Loss: 0.1303 | Val Acc: 0.9226 | Val F1: 0.9249
2025-09-20 05:35:58,068 - INFO - EarlyStopping counter: 20 / 40
2025-09-20 05:36:08,353 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:36:08,355 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:36:33,725 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:36:33,727 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:36:42,989 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:36:42,991 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:36:46,254 - INFO - Epoch 130/200 | LR: 1.50e-05 | Train Loss: 0.5550 | Val Loss: 0.1486 | Val Acc: 0.9009 | Val F1: 0.9040
2025-09-20 05:36:46,255 - INFO - EarlyStopping counter: 21 / 40
2025-09-20 05:37:22,731 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:37:22,733 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:37:35,416 - INFO - Epoch 131/200 | LR: 1.47e-05 | Train Loss: 0.5639 | Val Loss: 0.1334 | Val Acc: 0.9071 | Val F1: 0.9099
2025-09-20 05:37:35,417 - INFO - EarlyStopping counter: 22 / 40
2025-09-20 05:37:39,019 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:37:39,021 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:38:00,744 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:38:00,746 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:38:24,277 - INFO - Epoch 132/200 | LR: 1.43e-05 | Train Loss: 0.5321 | Val Loss: 0.1478 | Val Acc: 0.9040 | Val F1: 0.9085
2025-09-20 05:38:24,278 - INFO - EarlyStopping counter: 23 / 40
2025-09-20 05:38:47,984 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:38:47,986 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:38:58,723 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:38:58,725 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:39:12,743 - INFO - Epoch 133/200 | LR: 1.39e-05 | Train Loss: 0.4734 | Val Loss: 0.1423 | Val Acc: 0.9133 | Val F1: 0.9154
2025-09-20 05:39:12,745 - INFO - EarlyStopping counter: 24 / 40
2025-09-20 05:40:01,950 - INFO - Epoch 134/200 | LR: 1.35e-05 | Train Loss: 0.4694 | Val Loss: 0.1464 | Val Acc: 0.9040 | Val F1: 0.9044
2025-09-20 05:40:01,952 - INFO - EarlyStopping counter: 25 / 40
2025-09-20 05:40:02,618 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:40:02,620 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:40:50,703 - INFO - Epoch 135/200 | LR: 1.32e-05 | Train Loss: 0.5637 | Val Loss: 0.1218 | Val Acc: 0.9133 | Val F1: 0.9148
2025-09-20 05:40:50,704 - INFO - EarlyStopping counter: 26 / 40
2025-09-20 05:41:29,351 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:41:29,352 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:41:39,897 - INFO - Epoch 136/200 | LR: 1.28e-05 | Train Loss: 0.5647 | Val Loss: 0.1421 | Val Acc: 0.9009 | Val F1: 0.9039
2025-09-20 05:41:39,898 - INFO - EarlyStopping counter: 27 / 40
2025-09-20 05:42:29,075 - INFO - Epoch 137/200 | LR: 1.25e-05 | Train Loss: 0.5330 | Val Loss: 0.1320 | Val Acc: 0.9257 | Val F1: 0.9279
2025-09-20 05:42:29,076 - INFO - EarlyStopping counter: 28 / 40
2025-09-20 05:43:18,340 - INFO - Epoch 138/200 | LR: 1.21e-05 | Train Loss: 0.5057 | Val Loss: 0.1233 | Val Acc: 0.9133 | Val F1: 0.9157
2025-09-20 05:43:18,341 - INFO - EarlyStopping counter: 29 / 40
2025-09-20 05:44:07,558 - INFO - Epoch 139/200 | LR: 1.18e-05 | Train Loss: 0.4569 | Val Loss: 0.1254 | Val Acc: 0.9226 | Val F1: 0.9236
2025-09-20 05:44:07,559 - INFO - EarlyStopping counter: 30 / 40
2025-09-20 05:44:56,868 - INFO - Epoch 140/200 | LR: 1.14e-05 | Train Loss: 0.4421 | Val Loss: 0.1296 | Val Acc: 0.9133 | Val F1: 0.9137
2025-09-20 05:44:56,869 - INFO - EarlyStopping counter: 31 / 40
2025-09-20 05:45:45,825 - INFO - Epoch 141/200 | LR: 1.11e-05 | Train Loss: 0.6091 | Val Loss: 0.1087 | Val Acc: 0.9195 | Val F1: 0.9204
2025-09-20 05:45:45,826 - INFO - EarlyStopping counter: 32 / 40
2025-09-20 05:46:35,120 - INFO - Epoch 142/200 | LR: 1.07e-05 | Train Loss: 0.5078 | Val Loss: 0.1158 | Val Acc: 0.9164 | Val F1: 0.9188
2025-09-20 05:46:35,121 - INFO - EarlyStopping counter: 33 / 40
2025-09-20 05:47:24,151 - INFO - Epoch 143/200 | LR: 1.04e-05 | Train Loss: 0.4663 | Val Loss: 0.1258 | Val Acc: 0.9102 | Val F1: 0.9123
2025-09-20 05:47:24,152 - INFO - EarlyStopping counter: 34 / 40
2025-09-20 05:47:25,948 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:47:25,950 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:48:12,754 - INFO - Epoch 144/200 | LR: 1.01e-05 | Train Loss: 0.4656 | Val Loss: 0.1287 | Val Acc: 0.9133 | Val F1: 0.9157
2025-09-20 05:48:12,755 - INFO - EarlyStopping counter: 35 / 40
2025-09-20 05:48:45,514 - WARNING - Invalid attention weights detected, using uniform attention as fallback.
2025-09-20 05:48:45,516 - WARNING - NaN/Inf detected in model logits, skipping batch.
2025-09-20 05:49:01,741 - INFO - Epoch 145/200 | LR: 9.73e-06 | Train Loss: 0.4643 | Val Loss: 0.1141 | Val Acc: 0.9257 | Val F1: 0.9275
2025-09-20 05:49:01,741 - INFO - EarlyStopping counter: 36 / 40
2025-09-20 05:49:51,003 - INFO - Epoch 146/200 | LR: 9.40e-06 | Train Loss: 0.4290 | Val Loss: 0.1232 | Val Acc: 0.9164 | Val F1: 0.9180
2025-09-20 05:49:51,004 - INFO - EarlyStopping counter: 37 / 40
2025-09-20 05:50:40,121 - INFO - Epoch 147/200 | LR: 9.08e-06 | Train Loss: 0.5419 | Val Loss: 0.1210 | Val Acc: 0.9226 | Val F1: 0.9237
2025-09-20 05:50:40,122 - INFO - EarlyStopping counter: 38 / 40
2025-09-20 05:51:29,204 - INFO - Epoch 148/200 | LR: 8.77e-06 | Train Loss: 0.4562 | Val Loss: 0.1347 | Val Acc: 0.9071 | Val F1: 0.9099
2025-09-20 05:51:29,205 - INFO - EarlyStopping counter: 39 / 40
2025-09-20 05:52:18,572 - INFO - Epoch 149/200 | LR: 8.46e-06 | Train Loss: 0.4554 | Val Loss: 0.1180 | Val Acc: 0.9257 | Val F1: 0.9282
2025-09-20 05:52:18,574 - INFO - EarlyStopping counter: 40 / 40
2025-09-20 05:52:18,574 - INFO - Early stopping triggered.
2025-09-20 05:52:18,574 - INFO - Loading best performing model from: results/best_model_29_Exp_V17_Hybrid_TopK_4.pth
2025-09-20 05:52:18,797 - INFO - 
========================= Starting Full Evaluation of Final Model: 29_Exp_V17_Hybrid_TopK_4 (Single Model with TTA) =========================
2025-09-20 05:52:42,516 - INFO - 
Final Model Performance Summary - 29_Exp_V17_Hybrid_TopK_4
  - Final Test Set Accuracy (Single Model + TTA): 88.8889%
  - Final Test Set F1-Score (Macro, Single Model + TTA): 88.5464%
2025-09-20 05:52:45,012 - INFO - Confusion matrix plot saved to: results/confusion_matrix_29_Exp_V17_Hybrid_TopK_4.png
2025-09-20 05:52:45,015 - INFO - All experiments have completed successfully.
2025-09-20 05:52:45,018 - INFO - All experiments completed successfully.
